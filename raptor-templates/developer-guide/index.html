<!DOCTYPE html><html><head><title>Raptor Templates: Developer Guide</title><meta http-equiv="content-type" content="text/html; charset=UTF-8"></meta><link rel="stylesheet" type="text/css" href="../../static/raptor-templates-developer-guide-head-4266e422.css">
<link rel="stylesheet" type="text/css" href="../../static/bootstrap-head-90c3692d.css">
<link rel="stylesheet" type="text/css" href="../../static/code-editor-head-6a226e30.css"><script type="text/javascript">var
_gaq=_gaq||[];_gaq.push(["_setAccount","UA-33982282-1"]);_gaq.push(["_trackPageview"]);(function(){var
a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var
b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script></head><body data-spy="scroll"><div class="navbar navbar-fixed-top"><div class="navbar-inner"><div class="container"><a class="brand" href="../../">RaptorJS</a><ul class="nav"><li class="divider-vertical"></li><li id="s807"><a href="../../get-started/">Get Started</a></li><li class="divider-vertical"></li><li id="s808" class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle">Learn<b class="caret"></b></a><ul class="dropdown-menu"><li id="s809"><a href="../../">Overview</a></li><li id="s810"><a href="../../get-started/">Get Started</a></li><li id="s811"><a href="../../tutorial/">Tutorial</a></li><li id="s812"><a href="../../api/">API Reference</a></li><li id="s813"><a href="../../faq/">FAQ</a></li><li class="divider"></li><li id="s814"><a href="../../modules-classes/">Modules and Classes</a></li><li id="s815"><a href="../../packaging/">Packaging and Extensions</a></li><li id="s816"><a href="../../module-loader/">Module Loader</a></li><li id="s817"><a href="../../optimizer/">Optimizer</a></li><li id="s818"><a href="../../raptor-templates/">Raptor Templates</a></li><li id="s819"><a href="../../widgets/">Widgets Framework</a></li><li id="s820"><a href="../../logging/">Logging</a></li><li id="s821"><a href="../../resource-search-path/">Resource Search Path</a></li><li id="s822"><a href="../../cross-environment/">Cross Environment Support</a></li></ul></li><li class="divider-vertical"></li><li id="s823" class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle">Community<b class="caret"></b></a><ul class="dropdown-menu"><li id="s824"><a href="https://github.com/raptorjs/raptorjs">Source code</a></li><li id="s825"><a href="https://github.com/raptorjs/raptorjs/issues">Issue Tracker</a></li><li id="s826"><a href="../../contribute/">Contribute</a></li><li id="s827"><a href="../../contributors/">Contributors</a></li><li class="divider"></li><li id="s828"><a href="http://groups.google.com/group/raptorjs">Discussion Forum</a></li><li class="divider"></li><li id="s829"><a href="http://twitter.com/raptorjs">Twitter (@raptorjs)</a></li><li id="s830"><a href="http://twitter.com/raptorjs">Google+</a></li></ul></li><li class="divider-vertical"></li><li id="s831" class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle">About<b class="caret"></b></a><ul class="dropdown-menu"><li id="s832"><a href="https://github.com/raptorjs/raptorjs/wiki/Release-Notes">Release Notes</a></li><li id="s833"><a href="../../design-philosophy/">Design Philosophy</a></li><li id="s834"><a href="../../license/">License</a></li><li id="s835"><a href="../../credits/">Credits</a></li><li id="s836"><a href="../../creators/">Creators</a></li></ul></li><li class="divider-vertical"></li></ul></div></div></div><div class="container"><div class="docs"><div class="bd"><div class="toc nav" id="docsNav"><div class="return">&laquo; Return to <a href="../../raptor-templates/">Raptor Templates</a></div><ul class="toc"><li class="toc toc-level-0"><a href="#Overview">Overview</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#Features_at_a_Glance">Features at a Glance</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#Introduction">Introduction</a><ul class="toc"><li class="toc toc-level-1"><a href="#Sample_Template">Sample Template</a><ul class="toc"></ul></li><li class="toc toc-level-1"><a href="#Template_Rendering">Template Rendering</a><ul class="toc"></ul></li><li class="toc toc-level-1"><a href="#Template_Directives_Overview">Template Directives Overview</a><ul class="toc"></ul></li><li class="toc toc-level-1"><a href="#Extensibility">Extensibility</a><ul class="toc"></ul></li></ul></li><li class="toc toc-level-0"><a href="#Expressions">Expressions</a><ul class="toc"><li class="toc toc-level-1"><a href="#Helper_Functions">Helper Functions</a><ul class="toc"></ul></li><li class="toc toc-level-1"><a href="#Expression_Escape_Sequences">Expression Escape Sequences</a><ul class="toc"></ul></li><li class="toc toc-level-1"><a href="#Expression_Handlers">Expression Handlers</a><ul class="toc"></ul></li></ul></li><li class="toc toc-level-0"><a href="#Template_Directives">Template Directives</a><ul class="toc"><li class="toc toc-level-1"><a href="#Template">Template</a><ul class="toc"><li class="toc toc-level-2"><a href="#ctemplate">&lt;c:template></a><ul class="toc"></ul></li><li class="toc toc-level-2"><a href="#cinclude">&lt;c:include></a><ul class="toc"></ul></li></ul></li><li class="toc toc-level-1"><a href="#Text_Replacement">Text Replacement</a><ul class="toc"><li class="toc toc-level-2"><a href="#XML_Escaping">XML Escaping</a><ul class="toc"></ul></li></ul></li><li class="toc toc-level-1"><a href="#Conditionals">Conditionals</a><ul class="toc"><li class="toc toc-level-2"><a href="#if_elseif_else">if...else-if...else</a><ul class="toc"></ul></li><li class="toc toc-level-2"><a href="#ChooseWhenOtherwise">choose…when…otherwise</a><ul class="toc"></ul></li><li class="toc toc-level-2"><a href="#Shorthand_conditionals">Shorthand conditionals</a><ul class="toc"></ul></li></ul></li><li class="toc toc-level-1"><a href="#Looping">Looping</a><ul class="toc"><li class="toc toc-level-2"><a href="#for">for</a><ul class="toc"><li class="toc toc-level-3"><a href="#Loop_status_variable">Loop status variable</a><ul class="toc"></ul></li><li class="toc toc-level-3"><a href="#Separator">Separator</a><ul class="toc"></ul></li></ul></li></ul></li><li class="toc toc-level-1"><a href="#Macros">Macros</a><ul class="toc"><li class="toc toc-level-2"><a href="#def">def</a><ul class="toc"></ul></li><li class="toc toc-level-2"><a href="#invoke">invoke</a><ul class="toc"></ul></li></ul></li><li class="toc toc-level-1"><a href="#Structure_Manipulation">Structure Manipulation</a><ul class="toc"><li class="toc toc-level-2"><a href="#attrs">attrs</a><ul class="toc"></ul></li><li class="toc toc-level-2"><a href="#content">content</a><ul class="toc"></ul></li><li class="toc toc-level-2"><a href="#replace">replace</a><ul class="toc"></ul></li><li class="toc toc-level-2"><a href="#strip">strip</a><ul class="toc"></ul></li></ul></li></ul></li><li class="toc toc-level-0"><a href="#Taglibs">Taglibs</a><ul class="toc"><li class="toc toc-level-1"><a href="#Runtime_Tag_Handlers">Runtime Tag Handlers</a><ul class="toc"></ul></li><li class="toc toc-level-1"><a href="#CompileTime_Tag_Handlers">Compile-Time Tag Handlers</a><ul class="toc"></ul></li><li class="toc toc-level-1"><a href="#CompileTime_Transformers">Compile-Time Transformers</a><ul class="toc"></ul></li><li class="toc toc-level-1"><a href="#TaglibHelperFunctions">Helper Functions</a><ul class="toc"></ul></li></ul></li><li class="toc toc-level-0"><a href="#JavaScript_API">JavaScript API</a><ul class="toc"><li class="toc toc-level-1"><a href="#Template_Rendering">Template Rendering</a><ul class="toc"><li class="toc toc-level-2"><a href="#Rendering_to_a_String">Rendering to a String</a><ul class="toc"></ul></li><li class="toc toc-level-2"><a href="#Rendering_to_a_Context">Rendering to a Context</a><ul class="toc"></ul></li></ul></li><li class="toc toc-level-1"><a href="#Template_Compilation">Template Compilation</a><ul class="toc"><li class="toc toc-level-2"><a href="#Compiling_a_Template">Compiling a Template</a><ul class="toc"></ul></li><li class="toc toc-level-2"><a href="#Loading_a_Compiled_Template">Loading a Compiled Template</a><ul class="toc"></ul></li></ul></li></ul></li><li class="toc toc-level-0"><a href="#Performance">Performance</a><ul class="toc"><li class="toc toc-level-1"><a href="#Sample_Compiled_Template">Sample Compiled Template</a><ul class="toc"></ul></li></ul></li><li class="toc toc-level-0"><a href="#Advanced">Advanced</a><ul class="toc"><li class="toc toc-level-1"><a href="#Creating_Taglibs">Creating Taglibs</a><ul class="toc"></ul></li><li class="toc toc-level-1"><a href="#Raptor_Templates_Compilation">Raptor Templates Compilation</a><ul class="toc"></ul></li></ul></li></ul></div><div class="docs-content"><h1 id="title">Raptor Templates: Developer Guide</h1><div class="message message-warning"><div class="icon"><i class="icon-warning-sign" style="font-size: 30px;"></i></div><div class="bd">Documentation In-Progress</div></div><div class="section section-level-0"><h2 id="Overview">Overview</h2><div class="bd"><div class="try-it"><h1><i class="icon-play-circle icon-large"></i> <a href="../../raptor-templates/try-online/" target="_blank">Try Raptor Templates Online</a></h1><div class="desc">Edit Raptor Templates in your browser with instant results!</div></div><p>The Raptor Templating Language is heavily inspired by <a href="http://genshi.edgewall.org/wiki/Documentation/xml-templates.html">Genshi XML Template Language</a> (an XML-based templating language for Python) with the good parts of JSP mixed
in. The Raptor Templating Language borrows most of the same features from
Genshi and includes a JavaScript compiler so that a template can be compiled to
native JavaScript code. The templating language is XML-based so that the XML
structure of an HTML document can be used to its full advantage to make it
easier for developers write easily readable templates and to provide optimal
output—including improved readability and optimized
output.</p><p>The Raptor Templating language is a proven templating language that is being
used at eBay in applications where every millisecond and byte counts. eBay will
continue to invest in Raptor Templates to ensure that it has a very healthy
ecosystem.</p></div></div><div class="section section-level-0"><h2 id="Features_at_a_Glance">Features at a Glance</h2><div class="bd"><ul><li>Not dogmatic—the decision to be logic-less, less-logic or more-logic is left to
the
users</li><li>Easily extensible <ul><li>Taglibs for easy extensibility</li><li>Allows full control over compiled output</li><li>Custom tag handlers with support for both compile-time tag handlers and runtime
tag
handlers</li><li>Custom helper functions</li><li>Custom compile-time template transformers</li></ul></li><li>Works in any JavaScript environment—including on the server (Node and Rhino)
and in all web browsers
</li><li>XML-based <ul><li>Smarter compiler that leverages the structure of HTML documents</li><li>Easy to validate</li><li>Extensible</li><li>Easily parseable with any off-the-shelf XML parser</li></ul></li><li>Designed with readability and code maintenance in mind</li><li>Optimized compiled output <ul><li>Templates are compiled to native JavaScript functions</li><li>Compiled code generated with minification in mind</li><li>Smart compiler and optimizer</li></ul></li><li>Optimized runtime <ul><li>Lightweight runtime</li><li>Optimized for performance and scalability</li></ul></li><li>Leverages the full power of JavaScript <ul><li>All expressions are JavaScript expressions (<code>eval</code> is <i>never</i> used)</li><li>Templates and macros compile down to native JavaScript functions</li><li>Conditional directives compile down to native JavaScript if-statements and
similar for most other
directives</li><li>Function closures utilized for scoped variables and nesting</li></ul></li><li><span class="popover-target" id="s837" title="Smart Whitespace Removal" data-content="&amp;#10; &lt;p&gt;&amp;#10; The compiler understands that whitespace inside &lt;code&gt;&amp;lt;textarea&amp;gt;&lt;/code&gt;&amp;#10; and &lt;code&gt;&amp;lt;textarea&amp;gt;&lt;/code&gt; tags should be preserved.&amp;#10; &lt;/p&gt;&amp;#10; &lt;p&gt;&amp;#10; Since templats are XML-based, the compiler knows that &amp;#10; extra whitespace between XML elements can be removed&amp;#10; and that extra whitespace in body text can be removed.&amp;#10; &lt;/p&gt;&amp;#10; ">Smart whitespace removal</span></li><li>Helpful error messages that provide friendly messages and line/column numbers.</li><li>Compiled code is nicely formatted and easy to debug</li></ul> </div></div><div class="section section-level-0"><h2 id="Introduction">Introduction</h2><div class="bd"><p>All Raptor templates are required to be well-formed XML. This constraint allows
the template language to use the structure of the XML document to its
advantage. For example, a template directive that controls structural logic can
be applied as an attribute of the element that it controls. In addition, unlike
in non-XML-based templating languages, whitespace removal rules are based on
the XML structure and not a string language directives. Despite a template
being well-formed XML, the output does not have to be well-formed XML which
makes the Raptor Templating Language flexible enough for using in all types of
web
applications.</p><p>The Raptor Templating Language aims to be easy to understand by utilizing
concepts that front-end developers are already familiar with such as XML/HTML
and JavaScript. While the Raptor Templating Language introduces a new grammar
on top of XHTML, it is not an entirely new language which reduces the learning
curve.</p><div class="section section-level-1"><h2 id="Sample_Template">Sample Template</h2><div class="bd"><p>Below is a sample Raptor HTML template:</p><div class="code-editor" id="s838"> <textarea id="s838-textarea" style="display: none;" name="code-47">&lt;c:template
    xmlns:c="core"
    name="demo"
    params="colors">
 
    &lt;!-- Colors available -->
    &lt;ul c:if="notEmpty(colors)">
        &lt;li c:for="color in colors">
            $color
        &lt;/li>
    &lt;/ul>
     
    &lt;!-- No colors available -->
    &lt;div c:if="empty(colors)">
        No colors!
    &lt;/div>
     
&lt;/c:template></textarea></div><p></p></div></div><div class="section section-level-1"><h2 id="Template_Rendering">Template Rendering</h2><div class="bd"><p>To produce output, a compiled template is invoked with the provided user data
that is required by the
template.</p><p>For example, given the following input data:</p><div class="code-editor" id="s839"> <textarea id="s839-textarea" style="display: none;" name="code-48">{
    colors: ["red", "green", "blue"]
}</textarea></div><p>The output of rendering the above sample template would be the following:</p><div class="code-editor" id="s840"> <textarea id="s840-textarea" style="display: none;" name="code-49">&lt;ul>&lt;li>red&lt;/li>&lt;li>green&lt;/li>&lt;li>blue&lt;/li>&lt;/ul></textarea></div><p>For comparison, given the following input data consisting of an empty array of
colors:</p><div class="code-editor" id="s841"> <textarea id="s841-textarea" style="display: none;" name="code-50">{
    colors: []
}</textarea></div><p>The output would be the following:</p><div class="code-editor" id="s842"> <textarea id="s842-textarea" style="display: none;" name="code-51">&lt;div>No colors!&lt;/div></textarea></div></div></div><div class="section section-level-1"><h2 id="Template_Directives_Overview">Template Directives Overview</h2><div class="bd"><p>Almost all of the Raptor templating directives can be used as either an
attribute or as an element. The template included above can be rewritten to
apply template directives as elements instead of as attributes to produce the
equivalent output. For
example:</p><table class="table table-bordered"><thead><tr><th>Applying directives using attributes</th><th>Applying directives using elements</th></tr></thead><tbody><tr><td style="width: 50%"><div class="code-editor" id="s843"> <textarea id="s843-textarea" style="display: none;" name="code-52">&lt;c:template
    xmlns:c="core"
    name="demo"
    params="colors">
 
    &lt;!-- Colors available -->
    &lt;ul c:if="notEmpty(colors)">
        &lt;li c:for="color in colors">
            $color
        &lt;/li>
    &lt;/ul>
     
    &lt;!-- No colors available -->
    &lt;div c:if="empty(colors)">
        No colors!
    &lt;/div>
     
&lt;/c:template></textarea></div></td><td style="width: 50%"><div class="code-editor" id="s844"> <textarea id="s844-textarea" style="display: none;" name="code-53">&lt;c:template
    xmlns:c="core"
    name="demo"
    params="colors">
  
    &lt;!-- Colors available -->
    &lt;c:if test="notEmpty(colors)">
        &lt;ul>
            &lt;c:for each="color in colors">
                &lt;li>
                    $color
                &lt;/li>
            &lt;/c:for>
        &lt;/ul>
    &lt;/c:if>
      
    &lt;!-- No colors available -->
    &lt;c:if test="empty(colors)">
        &lt;div>
            No colors!
        &lt;/div>
    &lt;/c:if>
     
&lt;/c:template></textarea></div></td></tr></tbody></table><p>The disadvantage of using elements to control structural logic is that they
change the nesting of the elements which can impact readability. For this
reason it is often more suitable to use
attributes.</p></div></div><div class="section section-level-1"><h2 id="Extensibility">Extensibility</h2><div class="bd"><p></p></div></div></div></div><div class="section section-level-0"><h2 id="Expressions">Expressions</h2><div class="bd"><p>Valid JavaScript expressions are allowed wherever expressions can be used
within a template. However, because templates must be well-formed XML you will
have problems if you try to use unescaped less than ("&lt;") and ampersand
("&amp;") characters as part of an expression since those characters are
special XML characters and would break parsing. You can choose to escape the
special characters (i.e. use "&amp;lt;" for "&lt;" and "&amp;amp;" for "&amp;")
or, preferably, you can choose to use any of the following equivalent binary
operators supported by the Raptor Templating
Language:</p><table class="expression-operators table table-striped table-bordered table-condensed"><thead><tr><th>JavaScript Operator</th><th>Raptor Equivalent</th></tr></thead><tbody><tr><td><code>&amp;&amp;</code></td><td><code>and</code></td></tr><tr><td><code>||</code></td><td><code>or</code></td></tr><tr><td><code>===</code></td><td><code>eq</code></td></tr><tr><td><code>!==</code></td><td><code>ne</code></td></tr><tr><td><code>&lt;</code></td><td><code>lt</code></td></tr><tr><td><code>></code></td><td><code>gt</code></td></tr><tr><td><code>&lt;=</code></td><td><code>le</code></td></tr><tr><td><code>>=</code></td><td><code>ge</code></td></tr></tbody></table><div class="section section-level-1"><h2 id="Helper_Functions">Helper Functions</h2><div class="bd"><p>Because expressions in Raptor Templates allow any JavaScript code, expressions
can make use of global functions. It is also possible to import functions
provided by taglibs as local variables to avoid the use of global functions.
See
<a href="#TaglibHelperFunctions"><nobr>Taglibs &raquo; Helper Functions</nobr> </a> for more details.</p></div></div><div class="section section-level-1"><h2 id="Expression_Escape_Sequences">Expression Escape Sequences</h2><div class="bd"><p>If the text "${" is intended to be part of the output then the "$" character
must be escaped using a backslash as shown in the following
code:</p><div class="code-editor" id="s845"> <textarea id="s845-textarea" style="display: none;" name="code-54">\${test} &lt;!-- Output: ${test} --></textarea></div><p>In the unlikely case that "\${" was intended to be part of the output then the
backslash must be escaped by another backslash as shown in the following
code:</p><div class="code-editor" id="s846"> <textarea id="s846-textarea" style="display: none;" name="code-55">\\${test} &lt;!-- Output: \${test} --></textarea></div></div></div><div class="section section-level-1"><h2 id="Expression_Handlers">Expression Handlers</h2><div class="bd"><p></p></div></div></div></div><div class="section section-level-0"><h2 id="Template_Directives">Template Directives</h2><div class="bd"><div class="section section-level-1"><h2 id="Template">Template</h2><div class="bd"><div class="section section-level-2"><h2 id="ctemplate">&lt;c:template></h2><div class="bd"><p>The root element of all templates should be a &lt;c:template> tag. This tag
defines the name of the template and the input parameters for the template. In
addition, XML namespaces corresponding to taglibs should be attached to the
root
element.</p><div class="code-editor" id="s847"> <textarea id="s847-textarea" style="display: none;" name="code-56">&lt;c:template
    xmlns:c="http://raptorjs.org/templates/core"
    name="greeting"
    params="name,count">
    ...  
&lt;/c:template></textarea></div><div class="message message-info"><div class="icon"><i class="icon-info-sign" style="font-size: 30px;"></i></div><div class="bd"><p>All taglib URIs support a "short name" that can be used as an alternative to a
long taglib URI. For example, the short name for
"http://raptorjs.org/templates/core" is "core". Therefore, the following will
work as
well:</p><div class="code-editor" id="s848"> <textarea id="s848-textarea" style="display: none;" name="code-57">&lt;c:template
    xmlns:c="core"
    name="greeting"
    params="name,count">
    ...
&lt;/c:template></textarea></div></div></div><p>The "names" attribute is required and when loaded the template will register
itself based on the name provided. The "params" attribute can be used to create
one or more local variables using corresponding properties from the provided
data object. The params attribute is optional, but if provided, it should
consist of a comma-separated list of variable
names.</p><div class="message message-info"><div class="icon"><i class="icon-info-sign" style="font-size: 30px;"></i></div><div class="bd"><p>The "params" attribute is used to create local variables that can be easily
accessed throughout the HTML template. Alternatively, properties of the data
object can be accessed directly. The following are
equivalent:</p><table class="table table-bordered"><thead><tr><th>With params</th><th>Without params</th></tr></thead><tbody><tr><td style="width: 50%"><div class="code-editor" id="s849"> <textarea id="s849-textarea" style="display: none;" name="code-58">&lt;c:template
    xmlns:c="core"
    name="greeting"
    params="name,count">
  
    Hello $name! 
    You have $count new messages.
  
&lt;/c:template></textarea></div></td><td style="width: 50%"><div class="code-editor" id="s850"> <textarea id="s850-textarea" style="display: none;" name="code-59">&lt;c:template
    xmlns:c="core"
    name="greeting">
  
    Hello ${data.name}! 
    You have ${data.count} new messages.
  
&lt;/c:template></textarea></div></td></tr></tbody></table><p>The benefit of declaring parameters is that the local variables will be
minified which can reduce the size of the compiled output if the variable is
used in many places. In addition, declaring params make it easier for other
developers to understand what input is expected for a
template.</p></div></div></div></div><div class="section section-level-2"><h2 id="cinclude">&lt;c:include></h2><div class="bd"><p>Another template can easily be included using the &lt;c:include> directive. The
"template" attribute is required to specify name of the template to include and
all other attributes are used as arguments to the
template.</p><div class="code-editor" id="s851"> <textarea id="s851-textarea" style="display: none;" name="code-60">&lt;c:include template="myTemplate" someArg="${someVar}" anotherArg="Hello"/></textarea></div><p>As shown in the above example, attributes are used to define the template data
for the included template. Alternatively, the
<code>template-data</code> attribute can be used to pass along a complete data object to use for the
included template as shown in the following
example:</p><div class="code-editor" id="s852"> <textarea id="s852-textarea" style="display: none;" name="code-61">&lt;c:include template="myTemplate" template-data="includeData"/></textarea></div><p>In the above example, <code>includeData</code> is an expression that resolves to a JavaScript object. The resolved JavaScript
object will then be used as the
<code>data</code> object for the included template.</p></div></div></div></div><div class="section section-level-1"><h2 id="Text_Replacement">Text Replacement</h2><div class="bd"><p>Dynamic text should be of the form &lt;variable-name> or
${{entity:lt}javascript-expression>}:</p><div class="code-editor" id="s853"> <textarea id="s853-textarea" style="display: none;" name="code-62">&lt;div>
    Hello $name!
&lt;/div>
&lt;div>
    Hello ${name.toUpperCase()}!
&lt;/div>
&lt;img src="$imgUrl"/></textarea></div><div class="section section-level-2"><h2 id="XML_Escaping">XML Escaping</h2><div class="bd"><p>By default, special XML characters in the output of an expression are always
escaped to prevent
<a href="http://en.wikipedia.org/wiki/Cross-site_scripting">cross-site scripting (XSS)</a> attacks. For example, given the following template:</p><div class="code-editor" id="s854"> <textarea id="s854-textarea" style="display: none;" name="code-63">Hello $name</textarea></div></div></div><p>And the following data:</p><div class="code-editor" id="s855"> <textarea id="s855-textarea" style="display: none;" name="code-64">{
    "name": "&lt;script>alert('Hello World')&lt;/script>"
}</textarea></div><p>The output would be the following:</p><div class="code-editor" id="s856"> <textarea id="s856-textarea" style="display: none;" name="code-65">Hello &amp;lt;script&amp;gt;alert('Hello World')&amp;lt;/script&amp;gt;!</textarea></div><p>In this example, the browser would not interpret the script tag since the XML
characters had been
escaped.</p><p>To disable XML escaping, the expression should be of the form ${xml:<span>&lt;</span>javascript-expression>}. The "xml" expression handler lets the compiler know
that XML is expected and that the XML characters should not be
escaped.</p></div></div><div class="section section-level-1"><h2 id="Conditionals">Conditionals</h2><div class="bd"><p></p><div class="section section-level-2"><h2 id="if_elseif_else">if...else-if...else</h2><div class="bd"><p>Any element or fragment of HTML can be made conditional using the c:if,
c:else-if or c:else
directive.</p><table class="table table-bordered"><thead><tr><th>Applied as an attribute</th><th>Applied as an element</th></tr></thead><tbody><tr><td style="width: 50%"><div class="code-editor" id="s857"> <textarea id="s857-textarea" style="display: none;" name="code-66">&lt;!--Simple if-->
&lt;div c:if="someCondition">
    Hello World
&lt;/div>

&lt;!--Complex if-->
&lt;div c:if="test === 'a'">
    A
&lt;/div>
&lt;div c:else-if="test === 'b'">
    B
&lt;/div>
&lt;div c:else-if="test === 'c'">
    c
&lt;/div>
&lt;div c:else="">
    Something else
&lt;/div></textarea></div></td><td style="width: 50%"><div class="code-editor" id="s858"> <textarea id="s858-textarea" style="display: none;" name="code-67">&lt;!--Simple if-->
&lt;c:if test="someCondition">
    &lt;div>
        Hello World
    &lt;/div>
&lt;/c:if>

&lt;!--Complex if-->
&lt;c:if test="test === 'a'">
    &lt;div>
        A
    &lt;/div>
&lt;/c:if>
&lt;c:else-if test="test === 'b'">
    &lt;div>
        B
    &lt;/div>
&lt;/c:else-if>
&lt;c:else-if test="test === 'c'">
    &lt;div>
        C
    &lt;/div>
&lt;/c:else-if>
&lt;c:else>
    &lt;div>
        Something else
    &lt;/div>
&lt;/c:else></textarea></div></td></tr></tbody></table></div></div><div class="section section-level-2"><h2 id="ChooseWhenOtherwise">choose…when…otherwise</h2><div class="bd"><p>The c:choose directive, in combination with the directives c:when and
c:otherwise provides advanced conditional processing for rendering one of
several alternatives. The first matching c:when branch is rendered, or, if no
c:when branch matches, the c:otherwise branch is
rendered.</p><table class="table table-bordered"><thead><tr><th>Applied as an attribute</th><th>Applied as an element</th></tr></thead><tbody><tr><td style="width: 50%"><div class="code-editor" id="s859"> <textarea id="s859-textarea" style="display: none;" name="code-68">&lt;c:choose>
    &lt;c:when test="myVar === 'A'">
        &lt;div>A&lt;/div>
    &lt;/c:when>
    &lt;c:when test="myVar === 'B'">
        &lt;div>B&lt;/div>
    &lt;/c:when>
    &lt;c:otherwise>
        &lt;div>Something else&lt;/div>
    &lt;/c:otherwise>
&lt;c:choose></textarea></div></td><td style="width: 50%"><div class="code-editor" id="s860"> <textarea id="s860-textarea" style="display: none;" name="code-69">&lt;c:choose>
    &lt;div c:when="myVar === 'A'">
        A
    &lt;/div>
    &lt;div c:when="myVar === 'B'">
        B
    &lt;/div>
    &lt;div c:otherwise="">
        Something else
    &lt;/div>
&lt;c:choose></textarea></div></td></tr></tbody></table><p>Given a value of "A" for "myVar", the output would be the following:</p><div class="code-editor" id="s861"> <textarea id="s861-textarea" style="display: none;" name="code-70">&lt;div>A&lt;/div></textarea></div><p>Given a value of "C" for "myVar", the output would be the following:</p><div class="code-editor" id="s862"> <textarea id="s862-textarea" style="display: none;" name="code-71">&lt;div>Something else&lt;/div></textarea></div></div></div><div class="section section-level-2"><h2 id="Shorthand_conditionals">Shorthand conditionals</h2><div class="bd"><p>Shorthand conditionals allow for conditional values inside attributes or
wherever expressions are allowed. Shorthand conditionals are of the following
form:<br><code>{?&lt;expression>;&lt;true-template>[;&lt;false-template>]}</code></p><p>For example:</p><div class="code-editor" id="s863"> <textarea id="s863-textarea" style="display: none;" name="code-72">&lt;div class="{?active;tab-active}">Hello&lt;/div></textarea></div><p>With a value of <code>true</code> for <code>active</code>, the output would be the following:</p><div class="code-editor" id="s864"> <textarea id="s864-textarea" style="display: none;" name="code-73">&lt;div class="tab-active">Hello&lt;/div></textarea></div><p>With a value of <code>false</code> for <code>active</code>, the output would be the following:</p><div class="code-editor" id="s865"> <textarea id="s865-textarea" style="display: none;" name="code-74">&lt;div>Hello&lt;/div></textarea></div><div class="message message-info"><div class="icon"><i class="icon-info-sign" style="font-size: 30px;"></i></div><div class="bd"><p>If the expression inside an attribute evalutes to <code>null</code> or an empty string then the attribute is not included in the output.</p></div></div><p>As shown in the previous example, the "else" block for shorthand conditionals
is optional. The usage of an else block is shown
below:</p><div class="code-editor" id="s866"> <textarea id="s866-textarea" style="display: none;" name="code-75">&lt;div class="{?active;tab-active;tab-inactive}">Hello&lt;/div></textarea></div><p>With a value of <code>false</code> for <code>active</code>, the output would be the following:</p><div class="code-editor" id="s867"> <textarea id="s867-textarea" style="display: none;" name="code-76">&lt;div class="tab-inactive">Hello&lt;/div></textarea></div></div></div></div></div><div class="section section-level-1"><h2 id="Looping">Looping</h2><div class="bd"><div class="section section-level-2"><h2 id="for">for</h2><div class="bd"><p>Any element can be repeated for every item in an array using the c:for
directive. The directive can be applied as an element or as an
attribute.</p><table class="table table-bordered"><thead><tr><th>Applied as an attribute</th><th>Applied as an element</th></tr></thead><tbody><tr><td style="width: 50%"><div class="code-editor" id="s868"> <textarea id="s868-textarea" style="display: none;" name="code-77">&lt;ul>
    &lt;li c:for="item in items">${item}&lt;/li>
&lt;/ul></textarea></div></td><td style="width: 50%"><div class="code-editor" id="s869"> <textarea id="s869-textarea" style="display: none;" name="code-78">&lt;ul>
    &lt;c:for each="item in items">
        &lt;li>${item}&lt;/li>
    &lt;/c:for>
&lt;/ul></textarea></div></td></tr></tbody></table><p>Given a value of <code>["red", "green", "blue"]</code> for <code>items</code>, the output would be the following:</p><div class="code-editor" id="s870"> <textarea id="s870-textarea" style="display: none;" name="code-79">&lt;ul>
    &lt;li>red&lt;/li>
    &lt;li>green&lt;/li>
    &lt;li>blue&lt;/li>
&lt;/ul></textarea></div><div class="section section-level-3"><h2 id="Loop_status_variable">Loop status variable</h2><div class="bd"><p>If while looping you need access to additional information about the status of
the looping then the "status-var" attribute can be specified to introduce a new
variable. The loop status variable supports the following
methods:</p><ul><li>getLength()</li><li>isLast()</li><li>isFirst()</li><li>getIndex()</li></ul><table class="table table-bordered"><thead><tr><th>Applied as an attribute</th><th>Applied as an element</th></tr></thead><tbody><tr><td style="width: 50%"><div class="code-editor" id="s871"> <textarea id="s871-textarea" style="display: none;" name="code-80">&lt;ul>
    &lt;li c:for="item in items; status-var=loopStatus">
        ${loopStatus.getIndex()+1}) ${item}
    &lt;/li>
&lt;/ul></textarea></div></td><td style="width: 50%"><div class="code-editor" id="s872"> <textarea id="s872-textarea" style="display: none;" name="code-81">&lt;ul>
    &lt;c:for each="item in items" status-var="loopStatus">
        &lt;li>
            ${loopStatus.getIndex()+1}) ${item}
        &lt;/li>
    &lt;/c:for>
&lt;/ul></textarea></div></td></tr></tbody></table><p>Given a value of <code>["red", "green", "blue"]</code> for items, the output would be the following:</p><div class="code-editor" id="s873"> <textarea id="s873-textarea" style="display: none;" name="code-82">&lt;ul>
    &lt;li>
        1) red
    &lt;/li>
    &lt;li>
        2) green
    &lt;/li>
    &lt;li>
        3) blue
    &lt;/li>
&lt;/ul></textarea></div></div></div><div class="section section-level-3"><h2 id="Separator">Separator</h2><div class="bd"><p>When looping over an array of items, a separator can be defined. The separator
will automatically be written to the output after each
iteration.</p><table class="table table-bordered"><thead><tr><th>Applied as an attribute</th><th>Applied as an element</th></tr></thead><tbody><tr><td style="width: 50%"><div class="code-editor" id="s874"> <textarea id="s874-textarea" style="display: none;" name="code-83">&lt;span c:for="item in items; separator=', '">
   ${item}
&lt;/span></textarea></div></td><td style="width: 50%"><div class="code-editor" id="s875"> <textarea id="s875-textarea" style="display: none;" name="code-84">&lt;c:for each="item in items" separator=", ">
    &lt;span>
        ${item}
    &lt;/span>
&lt;/c:for></textarea></div></td></tr></tbody></table><p>Given a value of <code>["red", "green", "blue"]</code> for items, the output would be the following:</p><div class="code-editor" id="s876"> <textarea id="s876-textarea" style="display: none;" name="code-85">&lt;span>red&lt;span>, &lt;span>green&lt;/span>, &lt;span>blue&lt;/span></textarea></div></div></div></div></div></div></div><div class="section section-level-1"><h2 id="Macros">Macros</h2><div class="bd"><p>Macros allow for reusable fragments within an HTML template. Macros can also be
parameterized. A macro can be defined using the &lt;c:de> directive and a macro
when defining a
macro.</p><div class="section section-level-2"><h2 id="def">def</h2><div class="bd"><p>The &lt;c:def> directive can be used to define a reusable function within a
template.</p><div class="code-editor" id="s877"> <textarea id="s877-textarea" style="display: none;" name="code-86">&lt;c:def function="greeting(name, count)">
    Hello $name! You have $count new messages.
&lt;/c:def></textarea></div><p>The above macro can then be invoked as part of any expression. Alternatively,
the
<a href="#invoke">&lt;c:invoke></a> directive can be used invoke a macro function using named attributes. The
following sample template shows how to use macro functions inside
expressions:</p><div class="code-editor" id="s878"> <textarea id="s878-textarea" style="display: none;" name="code-87">&lt;c:def function="greeting(name, count)">
    Hello $name! You have $count new messages.
&lt;/c:def>

&lt;p>
    ${greeting("John", 10)}
&lt;/p>
&lt;p>
    ${greeting("Frank", 20)}
&lt;/p></textarea></div><p>The output for the above template would be the following:</p><div class="code-editor" id="s879"> <textarea id="s879-textarea" style="display: none;" name="code-88">&lt;p>
    Hello John! You have 10 new messages.
&lt;/p>
&lt;p>
    Hello Frank! You have 20 new messages.
&lt;/p></textarea></div></div></div><div class="section section-level-2"><h2 id="invoke">invoke</h2><div class="bd"><p>The &lt;c:invoke> directive can be used to invoke a function defined using the
&lt;c:def> directive or a function that is part of the input to a template. The
&lt;c:invoke> directive allows arguments to be passed using element attributes,
but that format is only supported for functions that were previously defined
using the &lt;c:def>
directive.</p><div class="code-editor" id="s880"> <textarea id="s880-textarea" style="display: none;" name="code-89">&lt;c:def function="greeting(name, count)">
    Hello ${name}! You have ${count} new messages.
&lt;/c:def>
 
&lt;c:invoke function="greeting" name="John" count="${10}"/>
&lt;c:invoke function="greeting('Frank', 20)"/> 
</textarea></div><p>The output for the above template would be the following:</p><div class="code-editor" id="s881"><h2 class="code-editor-title">Output</h2> <textarea id="s881-textarea" style="display: none;" name="code-90">&lt;p>
    Hello John! You have 10 new messages.
&lt;/p>
&lt;p>
    Hello Frank! You have 20 new messages.
&lt;/p></textarea></div><div class="message message-info"><div class="icon"><i class="icon-info-sign" style="font-size: 30px;"></i></div><div class="bd"><p>NOTE: By default, the arguments will be of type "string" when using
&lt;c:invoke>. However, argument attributes support JavaScript expressions
which allow for other types of arguments.
Example:</p><div class="code-editor" id="s882"> <textarea id="s882-textarea" style="display: none;" name="code-91">count="10" &lt;!-- string argument -->
count="${10}"  &lt;!-- number argument --></textarea></div></div></div></div></div></div></div><div class="section section-level-1"><h2 id="Structure_Manipulation">Structure Manipulation</h2><div class="bd"><p></p><div class="section section-level-2"><h2 id="attrs">attrs</h2><div class="bd"><p>The <code>c:attrs</code> attribute allows attributes to be dynamically added to an element at runtime.
The value of the c:attrs attribute should be an expression that resolves to an
object with properties that correspond to the dynamic attributes. For
example:</p><div class="code-editor" id="s883"> <textarea id="s883-textarea" style="display: none;" name="code-92">&lt;div c:attrs="myAttrs">
    Hello World!
&lt;/div></textarea></div><p>Given a value of <code>{style: "background-color: #FF0000;", "class": "my-div"}</code> for the <code>myAttrs</code> variable, the output would then be the following:</p><div class="code-editor" id="s884"> <textarea id="s884-textarea" style="display: none;" name="code-93">&lt;div style="background-color: #FF0000;" class="my-div">
    Hello World!
&lt;/div></textarea></div></div></div><div class="section section-level-2"><h2 id="content">content</h2><div class="bd"><p>This directive replaces any nested content with the result of evaluating the
expression:</p><div class="code-editor" id="s885"> <textarea id="s885-textarea" style="display: none;" name="code-94">&lt;ul>
    &lt;li c:content="myExpr">Hello&lt;/li>
&lt;/ul></textarea></div><p>Given a value of <code>"Bye!"</code> for the value of <code>myExpr</code>, the output of the above template would be the following:</p><div class="code-editor" id="s886"> <textarea id="s886-textarea" style="display: none;" name="code-95">&lt;ul>
    &lt;li>Bye!&lt;/li>
&lt;/ul></textarea></div></div></div><div class="section section-level-2"><h2 id="replace">replace</h2><div class="bd"><p>This directive replaces the element itself with the result of evaluating the
expression:</p><div class="code-editor" id="s887"> <textarea id="s887-textarea" style="display: none;" name="code-96">&lt;div>
    &lt;span c:replace="myExpr">Hello&lt;/span>
&lt;/div></textarea></div><p>Given a value of "Bye!" for the value of "myExpr", the output of the above
template would be the following:
</p><div class="code-editor" id="s888"> <textarea id="s888-textarea" style="display: none;" name="code-97">&lt;div>
    Bye!
&lt;/div></textarea></div></div></div><div class="section section-level-2"><h2 id="strip">strip</h2><div class="bd"><p>This directive conditionally strips the top-level element from the output. If
the expression provided as the attribute value evaluates to true then the
element is stripped from the
output:</p><div class="code-editor" id="s889"> <textarea id="s889-textarea" style="display: none;" name="code-98">&lt;div>
    &lt;span c:strip="true">&lt;b>Hello&lt;/b>&lt;/span>
&lt;/div></textarea></div><div class="code-editor" id="s890"><h2 class="code-editor-title">Output</h2> <textarea id="s890-textarea" style="display: none;" name="code-99">&lt;div>
    &lt;b>Hello&lt;/b>
&lt;/div></textarea></div></div></div></div></div></div></div><div class="section section-level-0"><h2 id="Taglibs">Taglibs</h2><div class="bd"><p></p><div class="section section-level-1"><h2 id="Runtime_Tag_Handlers">Runtime Tag Handlers</h2><div class="bd"><p>Tag handlers allow templates to be extended by allowing the rendering of an
element template to be controlled by an external class/component. Handlers are
given a reference to their body fragment so that they can control how to handle
the rendering of their body content. In addition, a handler can introduce
scoped variables that are available to the nested body content
only.</p><p>For example, the &lt;test:greeting> handler might be used as follows:</p> <div class="code-editor" id="s891"> <textarea id="s891-textarea" style="display: none;" name="code-100">&lt;c:template
    xmlns:c="core"
    xmlns:test="test"
    name="simple-handlers">
     
    &lt;test:greeting name="World"/>
     
&lt;/c:template></textarea></div><div class="code-editor" id="s892"><h2 class="code-editor-title">Tag Handler Implementation</h2> <textarea id="s892-textarea" style="display: none;" name="code-101">raptor.defineClass(
    'taglibs.test.GreetingHandler',
    function(raptor) {
        return {
            process: function(input, context) {
                context.write("Hello " + input.name + "!");
            }
        }
    });</textarea></div><div class="code-editor" id="s893"><h2 class="code-editor-title">Output</h2> <textarea id="s893-textarea" style="display: none;" name="code-102">Hello World!</textarea></div><p>The following Taglib fragment shows how to associate a custom tag with a
runtime tag handler
class:</p><div class="code-editor" id="s894"> <textarea id="s894-textarea" style="display: none;" name="code-103">&lt;tag>
    &lt;name>greeting&lt;/name>
    &lt;handler-class>taglibs.test.GreetingHandler&lt;/handler-class>
    &lt;attribute name="name" type="string"/>
&lt;/tag></textarea></div><p>For more details on creating taglibs, please see the following sub-page: </p><ul><li><a href="../../raptor-templates/taglibs/">Advanced &raquo; Creating Taglibs</a></li></ul></div></div><div class="section section-level-1"><h2 id="CompileTime_Tag_Handlers">Compile-Time Tag Handlers</h2><div class="bd"><p>Raptor Templates allow custom tags to be handled both at runtime via runtime
tag handlers and also at compile-time via compile-time tag handlers. Raptor
Templates allow a "Node" class to be associated with a custom tag and this
class is required to implement one
method—<code>doGenerateCode</code>. As part of compilation process, a tree of nodes is built based on the input
template and to generate code, the
<code>generateCode</code> method of the root node is invoked which recursively invoke the <code>generateCode</code> method for all child nodes.</p><p>The following Taglib fragment shows how to associate a custom tag with a node
compiler
class:</p> <div class="code-editor" id="s895"> <textarea id="s895-textarea" style="display: none;" name="code-104">&lt;tag>
    &lt;name>if&lt;/name> 
    &lt;node-class>templating.taglibs.core.IfNode&lt;/node-class>
    &lt;attribute name="test" type="expression"/>
&lt;/tag></textarea></div><p>For more details on Raptor Templates compilation and creating taglibs, please
see the following sub-pages
</p><ul><li><a href="../../raptor-templates/compilation/">Advanced &raquo; Raptor Templates Compilation</a></li><li><a href="../../raptor-templates/taglibs/">Advanced &raquo; Creating Taglibs</a></li></ul></div></div><div class="section section-level-1"><h2 id="CompileTime_Transformers">Compile-Time Transformers</h2><div class="bd"><p>Raptor Templates allows code generation to be controlled by registering
compile-time tree transformers. Transformers have full control over the parsed
node tree before the code generation phase. Transformers can manipulate the
node tree in any way, including removing/adding/rearranging nodes,
adding/removing element attributes,
etc.</p><p>As an example, the core taglib registers a transform that looks for the <code>c:if</code> attribute on all elements and will surround the node with a new <code>&lt;c:if></code> node.</p> <p>For more details on Raptor Templates compilation and registering transformers,
please see the following sub-pages
</p><ul><li><a href="../../raptor-templates/compilation/">Advanced &raquo; Raptor Templates Compilation</a></li><li><a href="../../raptor-templates/taglibs/">Advanced &raquo; Creating Taglibs</a></li></ul></div></div><div class="section section-level-1"><h2 id="TaglibHelperFunctions">Helper Functions</h2><div class="bd"><p>Raptor Template taglibs can export helper functions that can be used in any
template that imports the functions. Imported helper functions be used inside
any JavaScript
expression.</p><p>The following code shows how to import and use functions inside a Raptor
Template:</p><div class="code-editor" id="s896"> <textarea id="s896-textarea" style="display: none;" name="code-105">&lt;c:template
    xmlns:test="test"
    xmlns:c="core"
    test:functions="reverse">
    
    &lt;div>${reverse('reverse test')}&lt;/div>
    
&lt;/c:template></textarea></div><p>The output for the above rendered template would be the following:</p><div class="code-editor" id="s897"> <textarea id="s897-textarea" style="display: none;" name="code-106">&lt;div>tset esrever&lt;/div></textarea></div><p>Helper functions can be registered as part of a taglib as shown in the
following taglib code
fragment:</p><div class="code-editor" id="s898"> <textarea id="s898-textarea" style="display: none;" name="code-107">&lt;function name="reverse" class="taglibs.test.TestFunctions"/></textarea></div><p>The above fragment registers a helper function and tells the Raptor Template
compiler where the implementation for the function can be found. The sample
code below illustrates how to implement helper
functions:</p><div class="code-editor" id="s899"> <textarea id="s899-textarea" style="display: none;" name="code-108">raptor.define(
    "taglibs.test.TestFunctions",
    function() {
        return {
            reverse: function(str) {
                var out = "";
                for (var i=str.length-1; i>=0; i--) {
                    out += str.charAt(i); 
                }
                return out;
            }
        }
    });</textarea></div><p>For more details on creating taglibs, please see the following sub-page: </p><ul><li><a href="../../raptor-templates/taglibs/">Advanced &raquo; Creating Taglibs</a></li></ul> </div></div></div></div><div class="section section-level-0"><h2 id="JavaScript_API">JavaScript API</h2><div class="bd"><p></p><div class="section section-level-1"><h2 id="Template_Rendering">Template Rendering</h2><div class="bd"><p></p><div class="section section-level-2"><h2 id="Rendering_to_a_String">Rendering to a String</h2><div class="bd"><p>The <code>template.renderToString(templateName, template-data)</code> method can be used to render a template to a string.</p><div class="code-editor" id="s900"> <textarea id="s900-textarea" style="display: none;" name="code-109">var templating = raptor.require("templating");
var output = templating.renderToString("test/Person", {person: person});</textarea></div><div class="message message-info"><div class="icon"><i class="icon-info-sign" style="font-size: 30px;"></i></div><div class="bd"><p>NOTE: On the server, if the template cannot be found then the templating module
will convert the template name to a path and try to load the template. The
templating module actually checks two paths as illustrated by the
following:</p> Input template name: <code>"test/Person"</code><br> Paths checked: <ol><li><code>/test/Person.rtmpl</code></li><li><code>/test/Person/Person.rtmpl</code></li></ol></div></div></div></div><div class="section section-level-2"><h2 id="Rendering_to_a_Context">Rendering to a Context</h2><div class="bd"><p>Instead of rendering a template to a new string, the output of rendering a
template can be added to an existing "context". A context is an object that
gets created every time a template is rendered if a context is not provided. At
a minimum, a context should contain a
<code>write(str)</code> method that is used to add output to an output buffer and a <code>getOutput()</code> method that is used to get the string output.</p><p>The following code illustrates how to render a template to an existing context:</p><div class="code-editor" id="s901"> <textarea id="s901-textarea" style="display: none;" name="code-110">var templating = raptor.require("templating");
var context = templating.createContext();
templating.render("test/Person", {person: person}, context);
var output = context.getOutput();</textarea></div></div></div></div></div><div class="section section-level-1"><h2 id="Template_Compilation">Template Compilation</h2><div class="bd"><p></p><div class="section section-level-2"><h2 id="Compiling_a_Template">Compiling a Template</h2><div class="bd"><p>If you prefer to only compile a code to JavaScript then the following code can
be
used:</p><div class="code-editor" id="s902"> <textarea id="s902-textarea" style="display: none;" name="code-111">var compiler = raptor.require("templating.compiler");
var compilerOptions = {
    preserveWhitespace: true
};
var jsSource = compiler.compile('&lt;c:template \
        xmlns:c="core"> \
        name="greeting" \
        params="name"> \
            Hello ${name}! \
        &lt;/c:template>', 
        compilerOptions);</textarea></div><div class="message message-info"><div class="icon"><i class="icon-info-sign" style="font-size: 30px;"></i></div><div class="bd">The the <code>compilerOptions</code> argument is optional but allows additional options to be passed to the
compiler to control the compiled output. The default options are the following:
<div class="code-editor" id="s903"> <textarea id="s903-textarea" style="display: none;" name="code-112">{
    minify: false,
    preserveWhitespace: {
        'pre': true,
        'textarea': true
    },
    allowSelfClosing: {
        'script': false,
        'div': false,
        'textarea': false,
        'li': false,
        'b': false,
        'a': false,
        'i': false
    },
    startTagOnly: {
        'img': true,
        'br': true,
        'input': true
    }
}</textarea></div><p>For more details on the supported compiler options please see the following
sub-page:</p><ul><li><a href="../../raptor-templates/compilation/">Advanced &raquo; Raptor Templates Compilation</a></li></ul></div></div></div></div><div class="section section-level-2"><h2 id="Loading_a_Compiled_Template">Loading a Compiled Template</h2><div class="bd"><p></p> </div></div></div></div></div></div><div class="section section-level-0"><h2 id="Performance">Performance</h2><div class="bd"><p>Raptor Templates were designed for optimal performance for use in applications
with the toughest constraints by producing compiled templates with the minimal
amount of code while also focusing on runtime
performance.</p><p>The compiled output of Raptor Templates is kept minimal to reduce the amount of
bytes that need to be sent over the wire and to reduce the amount of time that
is required for a template's compiled code to be parsed and executed by a
JavaScript environment. Local variables are used wherever possible to improve
minification and short method names are used to keep the compiled size to a
minimum.</p><p>The rendering time of Raptor Templates is kept to a minimum by fine-tuning the
compiler. In addition, developers have complete flexibility to control how the
compiled output is generated to allow for the most demanding performance
constraints.
</p><div class="section section-level-1"><h2 id="Sample_Compiled_Template">Sample Compiled Template</h2><div class="bd"><div class="code-editor" id="s904"><h2 class="code-editor-title">Input Template</h2> <textarea id="s904-textarea" style="display: none;" name="code-113">&lt;c:template 
    xmlns:c="core" 
    params="name,colors">
    
    Hello $name!

    &lt;c:choose>
        &lt;ul c:when="notEmpty(colors)">
            &lt;li c:for="color in colors">
                $color
            &lt;/li>
        &lt;/ul>
        &lt;div c:otherwise="">
            No colors!
        &lt;/div>
    &lt;/c:choose>
    
&lt;/c:template></textarea></div><div class="code-editor" id="s905"><h2 class="code-editor-title">Unminified Compiled Output</h2> <textarea id="s905-textarea" style="display: none;" name="code-114">$rset("rhtml", "test", function(helpers){
  var empty=helpers.e,
      notEmpty=helpers.ne,
      escapeXml=helpers.x,
      forEach=helpers.f;

  return function(data, context){
    var name=data.name,
        colors=data.colors;

    context.w('Hello ')
      .w(escapeXml(name))
      .w('!');
    if (notEmpty(colors)) {
      context.w('&lt;ul>');
      forEach(colors, function(color) {
        context.w('&lt;li>')
          .w(escapeXml(color))
          .w('&lt;/li>');
      });

      context.w('&lt;/ul>');
    } else {
      context.w('&lt;div>No colors!&lt;/div>');
    }

  }
});</textarea></div><div class="code-editor" id="s906"><h2 class="code-editor-title">Minified Compiled Output</h2> <textarea id="s906-textarea" style="display: none;" name="code-115">$rset("rhtml","test",function(a){var e=a.ne,c=a.x,f=a.f;return function(a,b){var g=a.name,d=a.colors;b.w("Hello ").w(c(g)).w("!");e(d)?(b.w("&lt;ul>"),f(d,function(a){b.w("&lt;li>").w(c(a)).w("&lt;/li>")}),b.w("&lt;/ul>")):b.w("&lt;div>No colors!&lt;/div>")}});</textarea></div><table class="sizes table table-bordered"><thead><tr><th></th><th>Uncompressed</th><th>Gzipped</th></tr></thead><tbody><tr><td>Original Size:</td><td>454 bytes</td><td>248 bytes</td></tr><tr><td>Compiled Size:</td><td>243 bytes</td><td>178 bytes</td></tr></tbody></table> Saved 46.48% off the original size (28.23% off the gzipped size)</div></div></div></div><div class="section section-level-0"><h2 id="Advanced">Advanced</h2><div class="bd"><p></p><div class="section section-level-1"><h2 id="Creating_Taglibs">Creating Taglibs</h2><div class="bd"><p>Please see the sub-page, <a href="../../raptor-templates/taglibs/">Creating Taglibs</a>, for more details.</p></div></div><div class="section section-level-1"><h2 id="Raptor_Templates_Compilation">Raptor Templates Compilation</h2><div class="bd"><p>Please see the sub-page, <a href="../../raptor-templates/compilation/">Raptor Templates Compilation</a>, for more details.</p></div></div></div></div></div></div><div class="docs-footer"></div></div><div style="clear: both"></div><div class="footer footer-single-line"><div class="container"><div class="bd"><span class="powered-by">Powered by <a href="../../" class="raptorjs">RaptorJS</a> </span> &nbsp; | &nbsp; <a href="../../license/">License</a>&nbsp; | &nbsp; <a href="../../credits/">Credits</a><span class="back-to-top"><a href="#title">Back to Top</a></span></div></div></div></div><script type="text/javascript" src="../../static/core-body-f1e2805e.js"></script>
<script type="text/javascript" src="../../static/jquery-body-371da524.js"></script>
<script type="text/javascript" src="../../static/widgets-body-06552a07.js"></script>
<script type="text/javascript" src="../../static/raptor-templates-developer-guide-body-27a3f194.js"></script>
<script type="text/javascript" src="../../static/bootstrap-body-34d7fcf3.js"></script>
<script type="text/javascript" src="../../static/code-editor-body-a2bab28c.js"></script><script type="text/javascript">$rwidgets(
["components.nav.Nav.NavItemWidget","s807",0,0,0,0],
["components.nav.Nav.NavItemWidget","s808",0,0,0,0,
["components.nav.Nav.NavItemWidget","s809",0,0,0,0],
["components.nav.Nav.NavItemWidget","s810",0,0,0,0],
["components.nav.Nav.NavItemWidget","s811",0,0,0,0],
["components.nav.Nav.NavItemWidget","s812",0,0,0,0],
["components.nav.Nav.NavItemWidget","s813",0,0,0,0],
["components.nav.Nav.NavItemWidget","s814",0,0,0,0],
["components.nav.Nav.NavItemWidget","s815",0,0,0,0],
["components.nav.Nav.NavItemWidget","s816",0,0,0,0],
["components.nav.Nav.NavItemWidget","s817",0,0,0,0],
["components.nav.Nav.NavItemWidget","s818",0,0,0,0],
["components.nav.Nav.NavItemWidget","s819",0,0,0,0],
["components.nav.Nav.NavItemWidget","s820",0,0,0,0],
["components.nav.Nav.NavItemWidget","s821",0,0,0,0],
["components.nav.Nav.NavItemWidget","s822",0,0,0,0]],
["components.nav.Nav.NavItemWidget","s823",0,0,0,0,
["components.nav.Nav.NavItemWidget","s824",0,0,0,0],
["components.nav.Nav.NavItemWidget","s825",0,0,0,0],
["components.nav.Nav.NavItemWidget","s826",0,0,0,0],
["components.nav.Nav.NavItemWidget","s827",0,0,0,0],
["components.nav.Nav.NavItemWidget","s828",0,0,0,0],
["components.nav.Nav.NavItemWidget","s829",0,0,0,0],
["components.nav.Nav.NavItemWidget","s830",0,0,0,0]],
["components.nav.Nav.NavItemWidget","s831",0,0,0,0,
["components.nav.Nav.NavItemWidget","s832",0,0,0,0],
["components.nav.Nav.NavItemWidget","s833",0,0,0,0],
["components.nav.Nav.NavItemWidget","s834",0,0,0,0],
["components.nav.Nav.NavItemWidget","s835",0,0,0,0],
["components.nav.Nav.NavItemWidget","s836",0,0,0,0]],
["components.overlays.Popover.PopoverWidget","s837",0,0,{},0],
["components.editors.CodeEditor.CodeEditorWidget","s838",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s839",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s840",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s841",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s842",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s843",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s844",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s845",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s846",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s847",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s848",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s849",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s850",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s851",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s852",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s853",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s854",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s855",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s856",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s857",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s858",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s859",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s860",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s861",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s862",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s863",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s864",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s865",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s866",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s867",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s868",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s869",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s870",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s871",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s872",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s873",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s874",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s875",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s876",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s877",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s878",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s879",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s880",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s881",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s882",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s883",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s884",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s885",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s886",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s887",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s888",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s889",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s890",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s891",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s892",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s893",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s894",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s895",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s896",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s897",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s898",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s899",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s900",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s901",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s902",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s903",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s904",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s905",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s906",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0]);</script></body></html>
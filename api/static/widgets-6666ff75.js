define("raptor/widgets",function(e,t,n){"use strict";var r=function(e,t,n,r,i,s){this.type=t,this.id=e,this.assignedId=n,this.config=r,this.scope=i,this.events=s,this.children=[]};return r.prototype={elId:function(e){return arguments.length===0?this.id:this.id+"-"+e}},{addWidget:function(e,t,n,i,s,o,u,a){t||(t=this._nextWidgetId(a));var f=new r(t,e,n,i,o,u);s&&s.children.push(f);if(n&&!o)throw raptor.createError(new Error("Widget with an assigned ID is not scoped within another widget."));if(!s){var l=a.getAttributes();l.widgets||(l.widgets=[]),l.widgets.push(f)}return f},hasWidgets:function(e){var t=e.getAttributes();return t.widgets&&t.widgets.length!==0},_nextDocId:function(e){var t=e.getAttributes();return t.nextDocId||(t.nextDocId=1),t.nextDocId++}}});
define("raptor/pubsub",function(e,t,n){"use strict";var r=e("raptor/listeners"),i=define.Class({superclass:r.Message},function(){var e=function(e,t){r.Message.call(this,e,t),this.topic=e};return e.prototype={getTopic:function(){return this.topic}},e}),s=define.Class(function(){return{init:function(e){this.name=e,this.observable=r.createObservable()},publish:function(t,n){var i;return r.isMessage(t)?i=t:i=e("raptor/pubsub").createMessage(t,n),this.observable.publish(i),i},subscribe:function(e,t,n){return this.observable.subscribe(e,t,n)}}}),o={};return{channel:function(e){var t=o[e];return t||(t=new s(e),o[e]=t),t},global:function(){return this.channel("global")},publish:function(e,t){var n=this.global();n.publish.apply(n,arguments)},subscribe:function(e,t,n){var r=this.global();return r.subscribe.apply(r,arguments)},createMessage:function(e,t){return new i(e,t)}}});
define.extend("raptor/widgets",function(e,t){"use strict";var n=e("raptor/logging").logger("raptor/widgets"),r="prototype",i={},s="events",o=e("raptor"),u=e("raptor/widgets/Widget"),a=o.arrayFromArguments,f=0,l=function(e){this.widget=e,this.widgetsById={}};return l.prototype={addWidget:function(e,t){var n=this.widgetsById[t],r=this.widget,i;t.length>2&&t.substring(t.length-2)==="[]"&&(t=t.slice(0,-2),i=!0),n?n.push(e):this.widgetsById[t]=[e],i?(r[t]||(r[t]=[])).push(e):r[t]=e},getWidget:function(e){var t=this.widgetsById[e];if(!t||t.length===0)return undefined;if(t.length===1)return t[0];throw o.createError(new Error('getWidget: Multiple widgets found with ID "'+e+'"'))},getWidgets:function(e){return this.widgetsById[e]||[]}},{_initAll:function(f){var c=function(e,t,r){try{e.initWidget?e.initWidget(t):e.init(t)}catch(i){n.error('Unable to initialize widget of type "'+r+"'. Exception: "+i,i)}},h=function(e,t,n){e.onReady(function(){c(e,t,n)})},p=function(e,t){return this.publish(e,a(arguments,1))},d=function(e){var t={};return o.forEach(e,function(e){t[e[0]]={target:e[1],props:e[2]}},this),t},v=function(a,f){if(!a)return;var m=0,g=a.length,y;for(;m<g;m++){var b=a[m],w=b[0],E=b[1],S=b[2],x=b[3],T=b[4]||{},N=b[5]||{},C=b.slice(6);S===0&&(S=undefined),x===0&&(x=undefined),T===0&&(T=undefined),n.debug('Creating widget of type "'+w+'" ('+E+")");if(!e.exists(w))throw o.createError(new Error('Unable to initialize widget of type "'+w+'". The class for the widget was not found.'));var k=e(w);N&&(N=d(N));if(k.initWidget)T.elId=E,T.events=N,y=k,y.onReady=t.onReady;else{var L=u._init,A;L[r]=A=k[r],A.init=k,A._isWidget||o.extend(A,u,!1),y=new L(N),A.notify||(A.notify=p,A.on=A.subscribe),y.registerMessages(["beforeDestroy","destroy"],!1);var O=A[s]||k[s];O&&y.registerMessages(O,!1),y._id=E,y._assignedId=x,i[E]=y,x&&S&&i[S]._doc.addWidget(y,x),y._doc=new l(y)}C&&C.length&&v(C,y),y.initBeforeOnDomReady===!0?c(y,T,w):h(y,T,w)}};v(f)},get:function(e){return i[e]},_nextWidgetId:function(){return"c"+f++}}}),$rwidgets=function(){"use strict";require("raptor/widgets")._initAll(require("raptor").arrayFromArguments(arguments))};
define("raptor/widgets/Widget",["raptor"],function(e,t){"use strict";var n=e.forEach,r=t("raptor/listeners"),i=function(e,t,s){var o={widget:e},u;e.publish("beforeDestroy",o),r.unsubscribeFromAll(e),e.__destroyed=!0,t&&(u=e.getRootEl(),u&&u.parentNode.removeChild(u)),s&&n(e.getChildren(),function(e){i(e,t&&!u,!0)}),e.publish("destroy",o)};return{_isWidget:!0,_init:function(e){this._children=[],this._childrenById={},this._events=e},getObservable:function(){return this._observable||(this._observable=r.createObservable())},registerMessages:function(e,t){this.getObservable().registerMessages.apply(this,arguments)},publish:function(n,r){var i=this.getObservable();i.publish.apply(i,arguments);var s;this._events&&(s=this._events[n])&&(s.props&&(r=e.extend(r||{},s.props)),t("raptor/pubsub").publish(s.target,r))},subscribe:function(e,t,n){var r=this.getObservable();return r.subscribe.apply(r,arguments)},getElId:function(e){return e?this._id+"-"+e:this._id},getRootElId:function(){return this.getElId()},getEl:function(e){return document.getElementById(this.getElId(e))},getRootEl:function(){return this.getEl()},getWidget:function(e){var t=this._doc;return t?t.getWidget(e):null},getWidgets:function(e){var t=this._doc;return t?t.getWidgets(e):null},getChild:function(e){return this.getWidget(e)},getChildren:function(e){return this.getWidget(e)},getDoc:function(){return this._doc},getParent:function(){return this._parentWidget},getChildWidget:function(e){return this.getChild(e)},getChildWidgets:function(e){return this.getChildren.apply(this,arguments)},getParentWidget:function(){return this._parentWidget},destroy:function(e){i(this,!0,!0)},isDestroyed:function(){return this.__destroyed}}});
define.extend("raptor/widgets",function(e){"use strict";return{onReady:function(e,t){$(function(){e.call(t)})}}});
define.extend("raptor/widgets/Widget",function(e){"use strict";var t=e("raptor"),n=/\#(\w+)( .*)?/g,r=t.global;return{$:function(e){var t=arguments;if(t.length===1){if(typeof e=="function"){var i=this;$(function(){e.apply(i,t)})}else if(typeof e=="string"){var s=n.exec(e);n.lastIndex=0;if(s!=null){var o=s[1];return s[2]==null?$(this.getEl(o)):$("#"+this.getElId(o)+s[2])}var u=this.getEl();if(!u)throw new Error("Root element is not defined for widget");if(u)return $(e,u)}}else if(t.length===2){if(typeof t[1]=="string")return $(e,this.getEl(t[1]))}else if(t.length===0)return $(this.getEl());return $.apply(r,arguments)},onReady:function(e){var t=this;$(function(){e.call(t,t)})}}});
raptor.define("widgets",function(e){"use strict";var t=function(e,t,n,r,i){this.type=t,this.id=e,this.nestedWidgetId=n,this.config=r,this.parent=i,this.children=[],i&&i.children.push(this)};return t.prototype={elId:function(e){return arguments.length===0?this.id:this.id+"-"+e}},{addWidget:function(n,r,i,s,o,u){r||(r=this._nextWidgetId(u));var a=new t(r,n,i,s,o);i&&(o||e.throwError(new Error("Widget with an assigned ID is not scoped within another widget.")),a.docId=o.id);if(!o){var f=u.getAttributes();f.widgets||(f.widgets=[]),f.widgets.push(a)}return a},hasWidgets:function(e){var t=e.getAttributes();return t.widgets&&t.widgets.length!==0},_nextDocId:function(e){var t=e.getAttributes();return t.nextDocId||(t.nextDocId=1),t.nextDocId++}}});
raptor.extend("widgets",function(e,t){"use strict";var n="prototype",r={},i=e.errors,s=e.listeners,o="events",u=e.require("widgets.Widget"),a=e.arrayFromArguments,f=0,l=function(e){this.widget=e,this.widgetsById={}};return l.prototype={addWidget:function(e,t){var n=this.widgetsById[t],r=this.widget,i;t.length>2&&t.substring(t.length-2)==="[]"&&(t=t.slice(0,-2),i=!0),n?n.push(e):this.widgetsById[t]=[e],i?(r[t]||(r[t]=[])).push(e):r[t]=e},getWidget:function(t){var n=this.widgetsById[t];if(!n||n.length===0)return undefined;if(n.length===1)return n[0];e.throwError(new Error('getWidget: Multiple widgets found with ID "'+t+'"'))},getWidgets:function(e){return this.widgetsById[e]||[]}},{_initAll:function(f){var c=this.logger(),h={},p=function(e,t,n){try{e.initWidget?e.initWidget(t):e.init(t)}catch(r){c.error('Unable to initialize widget of type "'+n+"'. Exception: "+r,r)}},d=function(e,t,n){e.onReady(function(){p(e,t,n)})},v=function(e,t){return this.publish(e,a(arguments,1))},m=function(a,f){if(!a)return;var h=0,g=a.length,y;for(;h<g;h++){var b=a[h],w=b[0],E=b[1],S=b[2],x=b[3],T=b[4]||{},N=b.slice(5);S===0&&(S=undefined),x===0&&(x=undefined),T===0&&(x=undefined),c.debug('Creating widget of type "'+w+'" ('+E+")");var C=e.find(w);C||i.throwError(new Error('Unable to initialize widget of type "'+w+'". The class for the widget was not found.'));if(C.initWidget)T.elId=E,y=C,y.onReady=t.onReady;else{var k=u._init,L;k[n]=L=C[n],L.init=C,L._isWidget||e.extend(L,u,!1),y=new k,s.makeObservable(y,L),L.notify||(L.notify=v,L.on=L.subscribe),y.registerMessages(["beforeDestroy","destroy"],!1);var A=L[o]||C[o];A&&y.registerMessages(A,!1),y._id=E,y._childId=x,r[E]=y,x&&S&&r[S]._doc.addWidget(y,x),y._doc=new l(y)}N&&N.length&&m(N,y),y.initBeforeOnDomReady===!0?p(y,T,w):d(y,T,w)}};m(f)},get:function(e){return r[e]},_nextWidgetId:function(){return"c"+f++}}}),raptor.global.$rwidgets=function(){"use strict";var e=raptor.require("widgets");e._initAll(raptor.arrayFromArguments(arguments))}
raptor.defineMixin("widgets.Widget",{singleton:!0},function(e){"use strict";var t=e.forEach,n=e.require("listeners"),r=function(e,i,s){var o={widget:e},u;e.publish("beforeDestroy",o),n.unsubscribeFromAll(e),e.__destroyed=!0,i&&(u=e.getRootEl(),u&&u.parentNode.removeChild(u)),s&&t(e.getChildren(),function(e){r(e,i&&!u,!0)}),e.publish("destroy",o)};return{_isWidget:!0,_init:function(){this._children=[],this._childrenById={}},getElId:function(e){return e?this._id+"-"+e:this._id},getRootElId:function(e){return this.getElId()},getEl:function(e){return document.getElementById(this.getElId(e))},getRootEl:function(){return this.getEl()},getWidget:function(e){var t=this._doc;return t?t.getWidget(e):null},getWidgets:function(e){var t=this._doc;return t?t.getWidgets(e):null},getChild:function(e){return this.getWidget(e)},getChildren:function(e){return this.getWidget(e)},getDoc:function(){return this._doc},getParent:function(){return this._parentWidget},getChildWidget:function(e){return this.getChild(e)},getChildWidgets:function(e){return this.getChildren.apply(this,arguments)},getParentWidget:function(){return this._parentWidget},destroy:function(e){r(this,!0,!0)},isDestroyed:function(){return this.__destroyed}}});
raptor.extend("widgets",function(e){"use strict";return{onReady:function(e,t){$(function(){e.call(t)})}}});
raptor.extend("widgets.Widget",function(e){"use strict";var t=/\#(\w+)( .*)?/g,n=e.global;return{$:function(e){var r=arguments;if(r.length===1){if(typeof e=="function"){var i=this;$(function(){e.apply(i,r)})}else if(typeof e=="string"){var s=t.exec(e);t.lastIndex=0;if(s!=null){var o=s[1];return s[2]==null?$(this.getEl(o)):$("#"+this.getElId(o)+s[2])}var u=this.getEl();if(!u)throw new Error("Root element is not defined for widget");if(u)return $(e,u)}}else if(r.length===2){if(typeof r[1]=="string")return $(e,this.getEl(r[1]))}else if(r.length===0)return $(this.getEl());return $.apply(n,arguments)},onReady:function(e){var t=this;$(function(){e.call(t,t)})}}});
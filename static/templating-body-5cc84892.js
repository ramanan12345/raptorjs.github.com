$rload(function(e){"use strict";var t="",n=function(e){return e?e.trim():t},r=/\$\{([A-Za-z0-9_\.]+)\}/g;e.strings={compare:function(e,t){return e<t?-1:e>t?1:0},isEmpty:function(e){return e==null||n(e).length===0},length:function(e){return e==null?0:e.length},isString:e.isString,equals:function(e,t,r){return r!==!1&&(e=n(e),t=n(t)),e==t},notEquals:function(e,t,n){return this.equals(e,t,n)===!1},trim:n,ltrim:function(e){return e?e.replace(/^\s\s*/,""):t},rtrim:function(e){return e?e.replace(/\s\s*$/,""):t},startsWith:function(e,t){return!e||e.length<t.length?!1:e.substring(0,t.length)===t},endsWith:function(e,t){return!e||e.length<t.length?!1:e.substring(e.length-t.length)===t},unicodeEncode:function(e){return"\\u"+("0000"+(+e.charCodeAt(0)).toString(16)).slice(-4)},merge:function(e,t){var n,i=[],s=0;r.lastIndex=0;while(n=r.exec(e))i.push(e.substring(s,n.index)),i.push(t[n[1]]||""),s=r.lastIndex;return i.push(e.substring(s)),i.join("")}}});
$rload(function(e){"use strict";var t=function(){this.array=[],this.length=0};t.prototype={append:function(e){return typeof e!="string"&&(e=e.toString()),this.array.push(e),this.length+=e.length,this},toString:function(){return this.array.join("")},clear:function(){return this.array=[],this.length=0,this}},t.prototype.write=t.prototype.append,e.extendCore("strings",{StringBuilder:t,createStringBuilder:function(){return new t}})});
raptor.define("xml.utils",function(e){"use strict";var t=/[&<]/,n=/[&<]/g,r=/[&<>\"\'\n]/,i=/[&<>\"\'\n]/g,s={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;","\n":"&#10;"};return{escapeXml:function(e){return typeof e=="string"&&t.test(e)?e.replace(n,function(e){return s[e]}):e},escapeXmlAttr:function(e){return typeof e=="string"&&r.test(e)?e.replace(i,function(e){return s[e]}):e}}});
raptor.defineClass("templating.Context",function(e){"use strict";var t=e.forEachEntry,n=e.require("xml.utils").escapeXmlAttr,r=e.require("strings"),i=e.require("listeners"),s=r.StringBuilder,o=0,u,a=function(e,t){return function(){return e.apply(t,arguments)}},f=function(e){this.writer=e,this.w=this.write};f.prototype={getAttributes:function(){return this.attributes||(this.attributes={})},events:function(){return this.events||(this.events=i.createObservable()),this.events},uniqueId:function(){return o++},write:function(e){return e!==null&&e!==undefined&&(typeof e!="string"&&(e=e.toString()),this.writer.write(e)),this},getOutput:function(){return this.writer.toString()},captureString:function(e,t){var n=new s;return this.swapWriter(n,e,t),n.toString()},swapWriter:function(e,t,n){var r=this.writer;try{this.writer=e,t.call(n)}finally{this.writer=r}},invokeHandler:function(e,t){e.process(t,this)},getFunction:function(t,n){this._helpers||(this._helpers={});var r=t+":"+n,i=this._helpers[r],s;return i||(arguments.length===1?s=u[t]:s=e.require("templating").getFunction(t,n),i=this._helpers[r]=a(s,this)),i},isTagInput:function(e){return e&&e.hasOwnProperty("_tag")},renderTemplate:function(t,n){return e.require("templating").render(t,n,this),this},attr:function(e,t){if(t===null)t="";else{if(t===undefined||typeof t=="string"&&t.trim()==="")return this;t='="'+n(t)+'"'}return this.write(" "+e+t),this},attrs:function(e){return arguments.length===2?this.attr.apply(this,arguments):e&&t(e,this.attr,this),this},t:function(t,n,r,i,s){return n||(n={}),n._tag=!0,n.invokeBody=r,i&&(n.dynamicAttributes=i),s&&e.extend(n,s),this.invokeHandler(t,n),this},c:function(e){var t=this.captureString(e);return{toString:function(){return t}}}};var l=f.prototype;return l.a=l.attrs,l.h=l.getFunction,l.i=l.renderTemplate,f});
raptor.define("templating",function(e){"use strict";var t=function(e){return $rget("rhtml",e)},n={},r=e.isArray,i=e.require("strings"),s=i.StringBuilder,o=e.require("xml.utils").escapeXml,u=e.require("xml.utils").escapeXmlAttr,a=e.require("templating.Context"),f,l,c=function(t,n,r){var i=e.require(t),s=i[n]||i.prototype&&i.prototype[n];if(!s)throw e.createError(new Error('Helper function not found with name "'+n+'" in class "'+t+'"'));return s},h=function(e){return Array.isArray(e)===!0?e.length!==0:e};return f={render:function(r,i,s){if(!s)throw e.createError(new Error("Context is required"));var o=n[r];if(!o){o=t(r),!o&&this.findTemplate&&(this.findTemplate(r),o=t(r)),o&&(o=o(f.helpers));if(!o)throw e.createError(new Error('Template not found with name "'+r+'"'));n[r]=o}try{o(i||{},s)}catch(u){throw e.createError(new Error('Unable to render template with name "'+r+'". Exception: '+u),u)}},renderToString:function(e,t,n){var r=new s;if(n===undefined)this.render(e,t,new a(r));else{var i=this;n.swapWriter(r,function(){i.render(e,t,n)})}return r.toString()},unload:function(e){delete n[e]},getFunction:function(e,t){return arguments.length===1?l[e]:c(e,t)},createContext:function(e){return new a(e||new s)},helpers:{h:c,t:function(t){var n=e.require(t),r;return n.process?r=n:(r=n.instance)||(r=n.instance=new n),r},fv:function(e,t){if(!e)return;r(e)||(e=[e]);var n=0,i=e.length,s={getLength:function(){return i},isLast:function(){return n===i-1},isFirst:function(){return n===0},getIndex:function(){return n}};for(;n<i;n++){var o=e[n];t(o||"",s)}},f:e.forEach,fl:function(e,t){e!=null&&(r(e)||(e=[e]),t(e,0,e.length))},e:function(e){return!h(e)},ne:h,x:o,xa:u,nx:function(e){return{toString:function(){return e}}}}},l=f.helpers,f});
define.Class("raptor/render-context/Context",["raptor"],function(e,t){"use strict";var n=e.forEachEntry,r=t("raptor/xml/utils").escapeXmlAttr,i=t("raptor/strings/StringBuilder"),s=e.createError,o=0,u=function(e,t){return function(){return e.apply(t,arguments)}},a,f=function(e,n){var r=t(e),i=r[n]||r.prototype&&r.prototype[n];if(!i)throw s(new Error('Helper function not found with name "'+n+'" in class "'+e+'"'));return i},l=function(e){this.writer=e,this.w=this.write,this.listeners={}};return l.classFunc=f,l.prototype=a={getAttributes:function(){return this.attributes||(this.attributes={})},uniqueId:function(){return"c"+o++},write:function(e){return e!==null&&e!==undefined&&(typeof e!="string"&&(e=e.toString()),this.writer.write(e)),this},getOutput:function(){return this.writer.toString()},captureString:function(e,t){var n=new i;return this.swapWriter(n,e,t),n.toString()},swapWriter:function(e,t,n){var r=this.writer;try{this.writer=e,t.call(n)}finally{this.writer=r}},invokeHandler:function(e,t){var n=e.process||e.render;n.call(e,t,this)},getFunction:function(e,t){this._helpers||(this._helpers={});var n=e+":"+t,r=this._helpers[n];return r||(r=this._helpers[n]=u(f(e,t),this)),r},isTagInput:function(e){return e&&e.hasOwnProperty("_tag")},renderTemplate:function(e,n){return t("raptor/templating").render(e,n,this),this},attr:function(e,t,n){if(t===null)t="";else{if(t===undefined||typeof t=="string"&&t.trim()==="")return this;t='="'+(n===!1?t:r(t))+'"'}return this.write(" "+e+t),this},attrs:function(e){return arguments.length!==1?this.attr.apply(this,arguments):e&&n(e,this.attr,this),this},t:function(t,n,r,i,s){return n||(n={}),n._tag=!0,n.invokeBody=r,i&&(n.dynamicAttributes=i),s&&e.extend(n,s),this.invokeHandler(t,n),this},c:function(e){var t=this.captureString(e);return{toString:function(){return t}}}},a.a=a.attrs,a.f=a.getFunction,a.i=a.renderTemplate,l});
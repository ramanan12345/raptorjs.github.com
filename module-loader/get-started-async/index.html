<!DOCTYPE html><html><head><title>RaptorJS: Get Started using the Asynchronous Module Loader</title><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" type="text/css" href="../../static/module-loader-get-started-async-head-7832ccb5.css">
<link rel="stylesheet" type="text/css" href="../../static/bootstrap-head-90c3692d.css">
<link rel="stylesheet" type="text/css" href="../../static/code-editor-head-6a226e30.css"><script type="text/javascript">var
_gaq=_gaq||[];_gaq.push(["_setAccount","UA-33982282-1"]);_gaq.push(["_trackPageview"]);(function(){var
a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var
b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script></head><body><div class="navbar navbar-fixed-top"><div class="navbar-inner"><div class="container"><a class="brand" href="../../">RaptorJS</a><ul class="nav"><li class="divider-vertical"></li><li id="s398"><a href="../../get-started/">Get Started</a></li><li class="divider-vertical"></li><li id="s399" class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle">Learn<b class="caret"></b></a><ul class="dropdown-menu"><li id="s400"><a href="../../">Overview</a></li><li id="s401"><a href="../../get-started/">Get Started</a></li><li id="s402"><a href="../../tutorial/">Tutorial</a></li><li id="s403"><a href="../../api/">API Reference</a></li><li id="s404"><a href="../../faq/">FAQ</a></li><li class="divider"></li><li id="s405"><a href="../../modules-classes/">Modules and Classes</a></li><li id="s406"><a href="../../packaging/">Packaging and Extensions</a></li><li id="s407"><a href="../../module-loader/">Module Loader</a></li><li id="s408"><a href="../../optimizer/">Optimizer</a></li><li id="s409"><a href="../../raptor-templates/">Raptor Templates</a></li><li id="s410"><a href="../../widgets/">Widgets Framework</a></li><li id="s411"><a href="../../logging/">Logging</a></li><li id="s412"><a href="../../resource-search-path/">Resource Search Path</a></li><li id="s413"><a href="../../cross-environment/">Cross Environment Support</a></li></ul></li><li class="divider-vertical"></li><li id="s414" class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle">Community<b class="caret"></b></a><ul class="dropdown-menu"><li id="s415"><a href="https://github.com/raptorjs/raptorjs">Source code</a></li><li id="s416"><a href="https://github.com/raptorjs/raptorjs/issues">Issue Tracker</a></li><li id="s417"><a href="../../contribute/">Contribute</a></li><li id="s418"><a href="../../contributors/">Contributors</a></li><li class="divider"></li><li id="s419"><a href="http://groups.google.com/group/raptorjs">Discussion Forum</a></li><li class="divider"></li><li id="s420"><a href="http://twitter.com/raptorjs">Twitter (@raptorjs)</a></li><li id="s421"><a href="http://twitter.com/raptorjs">Google+</a></li></ul></li><li class="divider-vertical"></li><li id="s422" class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle">About<b class="caret"></b></a><ul class="dropdown-menu"><li id="s423"><a href="https://github.com/raptorjs/raptorjs/wiki/Release-Notes">Release Notes</a></li><li id="s424"><a href="../../design-philosophy/">Design Philosophy</a></li><li id="s425"><a href="../../license/">License</a></li><li id="s426"><a href="../../credits/">Credits</a></li><li id="s427"><a href="../../creators/">Creators</a></li></ul></li><li class="divider-vertical"></li></ul></div></div></div><div class="container"><div class="docs"><div class="bd"><div class="toc nav" id="docsNav"><ul class="toc"><li class="toc toc-level-0"><a href="#Overview">Overview</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#Sample_Code">Sample Code</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#View_Live_Code">View Live Code</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#Directory_Structure">Directory Structure</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#HTML_Page_Template">HTML Page Template</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#Downloading_Modules_Asynchronously">Downloading Modules Asynchronously</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#Rendering_the_Page">Rendering the Page</a><ul class="toc"></ul></li></ul><div class="docs-nav-footer"><ul><li><span class="powered-by">Powered by <a href="../../" class="raptorjs">RaptorJS</a></span></li><li><a href="../../license/">License</a></li><li><a href="../../credits/">Credits</a></li></ul></div></div><div class="docs-content"><h1 id="title">RaptorJS: Get Started using the Asynchronous Module Loader</h1><div class="message message-warning"><div class="icon"><i class="icon-warning-sign" style="font-size: 30px;"></i></div><div class="bd">Documentation In-Progress</div></div><div class="section section-level-0"><h2 id="Overview">Overview</h2><div class="bd"><p>The RaptorJS Asynchronous Loader is a lightweight module that allows JavaScript
and CSS resources to be downloaded asynchronously after an initial web page has
loaded. This async loader works in conjunction with the
<a href="../../optimizer/">RaptorJS Optimizer </a> to efficiently download resources from the server. </p><p>The RaptorJS Optimizer is needed to write the optimized resource bundles to
disk
<i>and</i> and to generate the metadata that the RaptorJS Async Loader requires to
efficiently download resources asynchronously. The metadata generated by the
RaptorJS Optimizer includes URLs that the loader uses to download resources
and, for optimal performance, the async loader will always download resources
in
<i>parallel</i> and execute resources in the order that they finish downloading.</p><p>For simplicity, this guide will make use of <a href="../../raptor-templates/">Raptor Templates</a> and the provided <a href="../../optimizer/taglib/">RaptorJS Optimizer Taglib</a> to begin using the RaptorJS Async Loader. However, Raptor Templates is not a
requirement for using the RaptorJS Async Loader (but it does make things a lot
easier
out-of-the-box).</p><p>For this guide, we are going to create a page that includes a module named
"module-a" synchronously (as part of the initial page load). In addition, the
page will asynchronously download a module named "module-b" when a button is
clicked. Both "module-a" and "module-b" will consist of both JavaScript and CSS
resources.</p></div></div><div class="section section-level-0"><h2 id="Sample_Code">Sample Code</h2><div class="bd"><p>The sample code for this guide can be downloaded using the following link: <a href="../../sample-projects/async-loader-get-started.zip"><nobr>RaptorJS Async Loader: Get Started - Sample Code </nobr></a></p></div></div><div class="section section-level-0"><h2 id="View_Live_Code">View Live Code</h2><div class="bd"><p>To view a live of demo of the application you will be creating using this
guide, use the following link:
<a href="../../src/sample-projects/async-loader/get-started/test-page.html"><nobr>RaptorJS Async Loader: Get Started - Live Demo</nobr></a></p></div></div><div class="section section-level-0"><h2 id="Directory_Structure">Directory Structure</h2><div class="bd"><p>For this guide, we will be using the directory structure shown below, but you
are free to use whatever directory structure you
prefer.</p><ul><li><b>/path/to/my-app/</b><ul><li><b>modules/</b><ul><li><b>module-a/</b><ul><li>package.json</li><li>module-a.js</li><li>module-a.css</li></ul></li><li><b>module-b/</b><ul><li>package.json</li><li>module-b.js</li><li>module-b.css</li></ul></li></ul></li><li><b>pages/</b><ul><li><b>test-page/</b><ul><li>test-page.css</li><li>test-page.js</li><li>test-page.rhtml</li></ul></li></ul></li><li>publish.js</li></ul></li></ul></div></div><div class="section section-level-0"><h2 id="HTML_Page_Template">HTML Page Template</h2><div class="bd"><p>Below is the page template ("test-page.rhtml") that we will use for this guide:</p><div class="code-editor" id="s428"> <textarea id="s428-textarea" style="display: none;" name="code-2">&lt;c:template
    xmlns:c="core"
    xmlns:html="html"
    xmlns:optimizer="optimizer">
    
    &lt;optimizer:page name="test-page" base-path="${data.outputDir}">
        &lt;includes>
            &lt;!-- Include the core RaptorJS module: -->
            &lt;module name="core"/>

            &lt;!-- Include the code to initialize RaptorJS: -->
            &lt;init-raptor/>

            &lt;!-- Include test page JS and CSS files: -->
            &lt;js path="test-page.js"/>
            &lt;css path="test-page.css"/>

            &lt;!-- "module-a" will be included as part of the initial page load (not asynchronous) -->
            &lt;module name="module-a"/>

            &lt;!-- "module-b" is marked as asynchronous -->
            &lt;module name="module-b" async="true"/>

            &lt;!-- Required for asynchronous module loading: -->
            &lt;module name="loader.require"/>
        &lt;/includes>
    &lt;/optimizer:page>
    
    &lt;html html:doctype="html">
        &lt;head>
            &lt;title>Async Module Loading Test Page&lt;/title>
            &lt;optimizer:slot name="head"/>
        &lt;/head>
        &lt;body>
            &lt;!-- When clicked, the following button will invoke TestPage.loadModuleBAsync 
                 defined in "test-page.js" -->
            &lt;button type="button" onclick="TestPage.loadModuleBAsync()">
                Load "module-b" Asynchrously
            &lt;/button>

            &lt;optimizer:slot name="body"/>
        &lt;/body>
    &lt;/html>

&lt;/c:template></textarea></div><p>You will notice that "module-b" is marked as asynchronous for the page includes
in the above
template.</p></div></div><div class="section section-level-0"><h2 id="Downloading_Modules_Asynchronously">Downloading Modules Asynchronously</h2><div class="bd"><p>The following code is used to download "module-b" asynchronously and then
invoke a method on the loaded
module:</p><div class="code-editor" id="s429"> <textarea id="s429-textarea" style="display: none;" name="code-3">raptor.require('module-b', function(moduleB) {
    moduleB.sayHello();
});</textarea></div><p>The source code for "module-b" is the following:</p><div class="code-editor" id="s430"> <textarea id="s430-textarea" style="display: none;" name="code-4">raptor.define(
    "module-b",
    function(raptor) {
        return {
            sayHello: function(to) {
                var div = document.createElement('div');
                div.className = 'module-b';
                div.innerHTML = 'Hello from "module-b"!';
                document.body.appendChild(div);
            }
        };
    });</textarea></div><div class="message message-info"><div class="icon"><i class="icon-info-sign" style="font-size: 30px;"></i></div><div class="bd"><p>If you would like to download multiple modules asynchronously then simply
provide an array of module IDs as shown in the following
example:</p><div class="code-editor" id="s431"> <textarea id="s431-textarea" style="display: none;" name="code-5">raptor.require(
    ['module-a', 'module-b'], 
    function(moduleA, moduleB) {
        //Do something with the loaded modules...
    });</textarea></div><p>In addition, you can also choose to use <code>raptor.require</code> to access the modules after they have been loaded:</p><div class="code-editor" id="s432"> <textarea id="s432-textarea" style="display: none;" name="code-6">raptor.require(
    ['module-a', 'module-b'], 
    function() {
        var moduleA = raptor.require('module-a');
        var moduleB = raptor.require('module-b');
        //Do something with the loaded modules...
    });</textarea></div></div></div></div></div><div class="section section-level-0"><h2 id="Rendering_the_Page">Rendering the Page</h2><div class="bd"><p>The sample project includes a script named "publish.js" that renders the
"test-page.rhtml" template shown above and saves the generated HTML string to
"test-page.html" in the root directory. In the process of rendering the page,
the RaptorJS Optimizer Taglib will write the optimized resource bundles to disk
(along with the metadata required by the RaptorJS Async
Loader).</p><p>To run the "publish.js" script, use the following command:</p><pre class="sh">
$ node publish.js
</pre><p>You should then see output to the following:</p><pre class="sh">
Generating staticfiles for RaptorJS Async Loader demo...
INFO optimizer.BundlesFileWriter: Writing bundle file to "static/test-page-async-body-45012617.js"...
INFO optimizer.BundlesFileWriter: Writing bundle file to "static/test-page-async-head-981b6ffe.css"...
INFO optimizer.BundlesFileWriter: Writing bundle file to "static/test-page-body-db70adfb.js"...
INFO optimizer.BundlesFileWriter: Writing bundle file to "static/test-page-head-d3ec3774.css"...
Test page written to "test-page.html"
</pre><p>For this sample project, the generated async loader metadata will look like the
following:</p><div class="code-editor" id="s433"> <textarea id="s433-textarea" style="display: none;" name="code-7">$rloaderMeta = {
    "module-b": {
        "css": ["static/test-page-async-head-981b6ffe.css"],
        "js":  ["static/test-page-async-body-45012617.js"]
    }
};

<p>
    The above code shows the URLs that will be downloaded
    when "module-b" is required asynchrously.
</p></textarea></div></div></div></div></div><div class="docs-footer-padding"></div></div></div><script type="text/javascript" src="../../static/core-body-2834a6ab.js"></script>
<script type="text/javascript" src="../../static/jquery-body-371da524.js"></script>
<script type="text/javascript" src="../../static/widgets-body-06552a07.js"></script>
<script type="text/javascript" src="../../static/module-loader-get-started-async-body-27a3f194.js"></script>
<script type="text/javascript" src="../../static/bootstrap-body-34d7fcf3.js"></script>
<script type="text/javascript" src="../../static/code-editor-body-a2bab28c.js"></script><script type="text/javascript">$rwidgets(
["components.nav.Nav.NavItemWidget","s398",0,0,0,0],
["components.nav.Nav.NavItemWidget","s399",0,0,0,0,
["components.nav.Nav.NavItemWidget","s400",0,0,0,0],
["components.nav.Nav.NavItemWidget","s401",0,0,0,0],
["components.nav.Nav.NavItemWidget","s402",0,0,0,0],
["components.nav.Nav.NavItemWidget","s403",0,0,0,0],
["components.nav.Nav.NavItemWidget","s404",0,0,0,0],
["components.nav.Nav.NavItemWidget","s405",0,0,0,0],
["components.nav.Nav.NavItemWidget","s406",0,0,0,0],
["components.nav.Nav.NavItemWidget","s407",0,0,0,0],
["components.nav.Nav.NavItemWidget","s408",0,0,0,0],
["components.nav.Nav.NavItemWidget","s409",0,0,0,0],
["components.nav.Nav.NavItemWidget","s410",0,0,0,0],
["components.nav.Nav.NavItemWidget","s411",0,0,0,0],
["components.nav.Nav.NavItemWidget","s412",0,0,0,0],
["components.nav.Nav.NavItemWidget","s413",0,0,0,0]],
["components.nav.Nav.NavItemWidget","s414",0,0,0,0,
["components.nav.Nav.NavItemWidget","s415",0,0,0,0],
["components.nav.Nav.NavItemWidget","s416",0,0,0,0],
["components.nav.Nav.NavItemWidget","s417",0,0,0,0],
["components.nav.Nav.NavItemWidget","s418",0,0,0,0],
["components.nav.Nav.NavItemWidget","s419",0,0,0,0],
["components.nav.Nav.NavItemWidget","s420",0,0,0,0],
["components.nav.Nav.NavItemWidget","s421",0,0,0,0]],
["components.nav.Nav.NavItemWidget","s422",0,0,0,0,
["components.nav.Nav.NavItemWidget","s423",0,0,0,0],
["components.nav.Nav.NavItemWidget","s424",0,0,0,0],
["components.nav.Nav.NavItemWidget","s425",0,0,0,0],
["components.nav.Nav.NavItemWidget","s426",0,0,0,0],
["components.nav.Nav.NavItemWidget","s427",0,0,0,0]],
["components.editors.CodeEditor.CodeEditorWidget","s428",0,0,{"mode":"xml","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s429",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s430",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s431",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s432",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0],
["components.editors.CodeEditor.CodeEditorWidget","s433",0,0,{"mode":"javascript","autoResize":true,"readOnly":true},0]);</script></body></html>
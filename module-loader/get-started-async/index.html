<!DOCTYPE html><html><head><title itemprop="name">RaptorJS: Get Started using the Asynchronous Module Loader</title><link rel="icon" href="../../favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon"><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" type="text/css" href="../../static/module-loader-get-started-async-091b9ba1.css">
<link rel="stylesheet" type="text/css" href="../../static/docs-8ce8bbe8.css">
<link rel="stylesheet" type="text/css" href="../../static/code-editor-f1386401.css">
<script type="text/javascript">var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-33982282-1"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
var __insp=__insp||[];__insp.push(["wid",2568045892]),function(){function e(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.id="inspsync",e.src=("https:"==document.location.protocol?"https":"http")+"://www.inspectlet.com/inspectlet-jq.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}window.attachEvent?window.attachEvent("onload",e):window.addEventListener("load",e,!1)}();</script></head><body><div class="navbar navbar-fixed-top"><div class="navbar-inner"><div class="container"><a class="brand" href="../../">RaptorJS</a><ul class="nav"><li class="divider-vertical"></li><li id="w430"><a href="../../get-started/">Get Started</a></li><li class="divider-vertical"></li><li id="w431" class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle">Learn<b class="caret"></b></a><ul class="dropdown-menu"><li id="w432"><a href="../../">Overview</a></li><li id="w433"><a href="../../get-started/">Get Started</a></li><li id="w434"><a href="../../tutorial/">Tutorial</a></li><li id="w435"><a href="../../api/">API Reference</a></li><li id="w436" target="_blank"><a href="https://github.com/raptorjs/samples">Sample Apps</a></li><li id="w437"><a href="../../faq/">FAQ</a></li><li class="divider"></li><li id="w438"><a href="../../modules-classes/">Modules and Classes</a></li><li id="w439"><a href="../../packaging/">Packaging and Extensions</a></li><li id="w440"><a href="../../module-loader/">Module Loader</a></li><li id="w441"><a href="../../optimizer/">Optimizer</a></li><li id="w442"><a href="../../raptor-templates/">Raptor Templates</a></li><li id="w443"><a href="../../widgets/">Widget Framework</a></li><li class="divider"></li><li id="w444"><a href="../../ui-components/">Building UI Components</a></li><li id="w445"><a href="../../logging/">Logging</a></li><li id="w446"><a href="../../resource-search-path/">Resource Search Path</a></li><li id="w447"><a href="../../cross-environment/">Cross Environment Support</a></li></ul></li><li class="divider-vertical"></li><li id="w448" class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle">Community<b class="caret"></b></a><ul class="dropdown-menu"><li id="w449"><a href="https://github.com/raptorjs/raptorjs">Source code</a></li><li id="w450"><a href="https://github.com/raptorjs/raptorjs/issues">Issue Tracker</a></li><li id="w451"><a href="../../contribute/">Contribute</a></li><li id="w452"><a href="../../contributors/">Contributors</a></li><li class="divider"></li><li id="w453"><a href="http://groups.google.com/group/raptorjs">Discussion Forum</a></li><li class="divider"></li><li id="w454"><a href="http://twitter.com/raptorjs">Twitter (@raptorjs)</a></li><li id="w455"><a href="https://plus.google.com/111493691067944627473/">Google+</a></li></ul></li><li class="divider-vertical"></li><li id="w456" class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle">About<b class="caret"></b></a><ul class="dropdown-menu"><li id="w457"><a href="https://github.com/raptorjs/raptorjs/wiki/Release-Notes">Release Notes</a></li><li id="w458"><a href="../../design-philosophy/">Design Philosophy</a></li><li id="w459"><a href="../../license/">License</a></li><li id="w460"><a href="../../credits/">Credits</a></li><li id="w461"><a href="../../creators/">Creators</a></li></ul></li><li class="divider-vertical"></li></ul></div></div></div><div class="container"><div class="docs"><div class="bd"><div class="docs-content"><h1 id="title">RaptorJS: Get Started using the Asynchronous Module Loader</h1><div class="toc nav" id="docsNav"><ul class="toc"><li class="toc toc-level-0"><a href="#Overview">Overview</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#View_Demo">View Demo</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#Demo_Source">Demo Source</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#HTML_Page_Template">HTML Page Template</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#Downloading_Modules_Asynchronously">Downloading Modules Asynchronously</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#Rendering_the_Page">Rendering the Page</a><ul class="toc"></ul></li><li class="toc toc-level-0"><a href="#Discussion">Discussion</a><ul class="toc"></ul></li></ul><div class="docs-nav-footer"><ul><li><span class="powered-by">Powered by <a href="../../" class="raptorjs">RaptorJS</a></span></li><li><a href="../../license/">License</a></li><li><a href="../../credits/">Credits</a></li></ul></div></div><div class="message message-warning"><div class="icon"><i class="icon-warning-sign" style="font-size: 30px;"></i></div><div class="bd">Documentation In-Progress</div></div><div class="section section-level-0"><h2 id="Overview">Overview</h2><div class="bd"><p>RaptorJS includes a lightweight AMD-compatible package/module loader that
allows JavaScript and CSS resources to be downloaded asynchronously after the
initial page load. This async loader works in conjunction with the
<a href="../../optimizer/">RaptorJS Optimizer </a> to efficiently download resources from the server. </p><p>The RaptorJS Optimizer is needed to write the optimized resource bundles to
disk
<i>and</i> and to generate the metadata that the RaptorJS Async Loader requires to
efficiently download resources asynchronously. The metadata generated by the
RaptorJS Optimizer includes URLs that the loader uses to download resources.
This optimically generated metadata removes the need for developers to embedded
manually maintained configuration data as part of a webpage. For optimal
performance, the async loader will always download resources in
<i>parallel</i> and execute resources in the order that they finish downloading.</p><p>For simplicity, this guide will make use of <a href="../../raptor-templates/">Raptor Templates</a> and the provided <a href="../../optimizer/taglib/">RaptorJS Optimizer Taglib</a> to begin using the RaptorJS Async Loader. However, Raptor Templates is not
required to use the RaptorJS Async Loader (but it does make things a lot easier
out-of-the-box).</p><p>For this guide, we are going to create a page that includes a module named
"module-a" synchronously (as part of the initial page load). In addition, the
page will asynchronously download a module named "module-b" when a button is
clicked. Both "module-a" and "module-b" will consist of both JavaScript and CSS
resources.</p></div></div><div class="section section-level-0"><h2 id="View_Demo">View Demo</h2><div class="bd"><div class="view-demo"><h1><i class="icon-play-circle icon-large"></i> <a href="../../demos/async-loader/" target="_blank">View Demo: Asynchronous Module Loading</a></h1></div></div></div><div class="section section-level-0"><h2 id="Demo_Source">Demo Source</h2><div class="bd">For this guide, we will use the following directory structure: <ul><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader">/async-loader/</a></b><ul><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/modules">modules/</a></b><ul><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/modules/module-a">module-a/</a></b><ul><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/modules/module-a/module-a.css">module-a.css</a></b></li><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/modules/module-a/module-a.js">module-a.js</a></b></li><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/modules/module-a/package.json">package.json</a></b></li></ul></li><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/modules/module-b">module-b/</a></b><ul><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/modules/module-b/module-b.css">module-b.css</a></b></li><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/modules/module-b/module-b.js">module-b.js</a></b></li><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/modules/module-b/package.json">package.json</a></b></li></ul></li></ul></li><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/optimizer-config.xml">optimizer-config.xml</a></b></li><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/package.json">package.json</a></b></li><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/pages">pages/</a></b><ul><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/pages/index">index/</a></b><ul><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/pages/index/index.css">index.css</a></b></li><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/pages/index/index.js">index.js</a></b></li><li><b><a href="https://github.com/raptorjs/samples/blob/master/async-loader/pages/index/index.rhtml">index.rhtml</a></b></li></ul></li></ul></li></ul></li></ul></div></div><div class="section section-level-0"><h2 id="HTML_Page_Template">HTML Page Template</h2><div class="bd"><p>Below is the page template ("test-page.rhtml") that we will use for this guide:</p><div class="code-editor" id="w462"> <textarea id="w462-textarea" style="display: none;" name="code-5"><c:template
    xmlns:c="core"
    xmlns:html="html"
    xmlns:optimizer="optimizer">
    
    <optimizer:page name="index" base-path="${data.outputDir}">
        <dependencies>
            <module name="raptor"/>
            <js path="index.js"/>
            <css path="index.css"/>
            <module name="module-a"/>
            <module name="module-b" async="true"/>

            <!-- Required for asynchronous module loading -->
            <module name="raptor/loader"/>
        </dependencies>
    </optimizer:page>
    
    <html html:doctype="html">
        <head>
            <title>Async Module Loading Test Page</title>
            <optimizer:slot name="head"/>
        </head>
        <body>
            <button type="button" onclick="TestPage.loadModuleBAsync()">Load "module-b" Asynchrously</button>
            <optimizer:slot name="body"/>
        </body>
    </html>

</c:template></textarea></div><p>You will notice that "module-b" is marked as asynchronous for the page includes
in the above
template.</p></div></div><div class="section section-level-0"><h2 id="Downloading_Modules_Asynchronously">Downloading Modules Asynchronously</h2><div class="bd"><p>The following code is used to download "module-b" asynchronously and then
invoke a method on the loaded
module:</p><div class="code-editor" id="w463"> <textarea id="w463-textarea" style="display: none;" name="code-6">require(['module-b'], function(moduleB) {
    moduleB.sayHello();
});</textarea></div><p>The source code for "module-b" is the following:</p><div class="code-editor" id="w464"> <textarea id="w464-textarea" style="display: none;" name="code-7">define(
    "module-b",
    function(require) {
        return {
            sayHello: function(to) {
                var div = document.createElement('div');
                div.className = 'module-b';
                div.innerHTML = 'Hello from "module-b"!';
                document.body.appendChild(div);
            }
        };
    });</textarea></div><div class="message message-info"><div class="icon"><i class="icon-info-sign" style="font-size: 30px;"></i></div><div class="bd"><p>If you would like to download multiple modules asynchronously then simply
provide an array of module IDs as shown in the following
example:</p><div class="code-editor" id="w465"> <textarea id="w465-textarea" style="display: none;" name="code-8">require.load(
    ['module-a', 'module-b'], 
    function(moduleA, moduleB) {
        //Do something with the loaded modules...
    });</textarea></div><p>In addition, you can also choose to use the <code>require</code> function to access the modules after they have been loaded:</p><div class="code-editor" id="w466"> <textarea id="w466-textarea" style="display: none;" name="code-9">require(
    ['module-a', 'module-b'], 
    function() {
        var moduleA = require('module-a');
        var moduleB = require('module-b');
        //Do something with the loaded modules...
    });</textarea></div></div></div></div></div><div class="section section-level-0"><h2 id="Rendering_the_Page">Rendering the Page</h2><div class="bd"><p>The sample project includes a script named "build.js" that renders the
"test-page.rhtml" template shown above and saves the generated HTML string to
"test-page.html" in the root directory. In the process of rendering the page,
the RaptorJS Optimizer Taglib will write the optimized resource bundles to disk
(along with the metadata required by the RaptorJS Async
Loader).</p><p>To run the "publish.js" script, use the following command:</p><pre class="sh">$ node publish.js</pre><p>You should then see output to the following:</p><pre class="sh">Generating staticfiles for RaptorJS Async Loader demo...
INFO optimizer.BundlesFileWriter: Writing bundle file to "static/test-page-async-body-45012617.js"...
INFO optimizer.BundlesFileWriter: Writing bundle file to "static/test-page-async-head-981b6ffe.css"...
INFO optimizer.BundlesFileWriter: Writing bundle file to "static/test-page-body-db70adfb.js"...
INFO optimizer.BundlesFileWriter: Writing bundle file to "static/test-page-head-d3ec3774.css"...
Test page written to "test-page.html"</pre><p>For this sample project, the generated async loader metadata will look like the
following:</p><div class="code-editor" id="w467"> <textarea id="w467-textarea" style="display: none;" name="code-10">$rloaderMeta = {
    "module-b": {
        "css": ["static/test-page-async-head-981b6ffe.css"],
        "js":  ["static/test-page-async-body-45012617.js"]
    }
};</textarea></div><p>The above code shows the URLs that will be downloaded when "module-b" is
required
asynchrously.</p></div></div><div class="section section-level-0"><h2 id="Discussion">Discussion</h2><div class="bd"><div id="disqus_thread"></div></div></div></div></div><div class="docs-footer-padding"></div></div></div><script type="text/javascript" src="../../static/core-f5729fb0.js"></script>
<script type="text/javascript" src="../../static/jquery-371da524.js"></script>
<script type="text/javascript" src="../../static/widgets-80dede79.js"></script>
<script type="text/javascript" src="../../static/module-loader-get-started-async-50b665d3.js"></script>
<script type="text/javascript" src="../../static/code-editor-1ae725c9.js"></script><script type="text/javascript">$rwidgets(
["components.nav.Nav.NavItemWidget","w430",0,0,0,0],
["components.nav.Nav.NavItemWidget","w431",0,0,0,0,
["components.nav.Nav.NavItemWidget","w432",0,0,0,0],
["components.nav.Nav.NavItemWidget","w433",0,0,0,0],
["components.nav.Nav.NavItemWidget","w434",0,0,0,0],
["components.nav.Nav.NavItemWidget","w435",0,0,0,0],
["components.nav.Nav.NavItemWidget","w436",0,0,0,0],
["components.nav.Nav.NavItemWidget","w437",0,0,0,0],
["components.nav.Nav.NavItemWidget","w438",0,0,0,0],
["components.nav.Nav.NavItemWidget","w439",0,0,0,0],
["components.nav.Nav.NavItemWidget","w440",0,0,0,0],
["components.nav.Nav.NavItemWidget","w441",0,0,0,0],
["components.nav.Nav.NavItemWidget","w442",0,0,0,0],
["components.nav.Nav.NavItemWidget","w443",0,0,0,0],
["components.nav.Nav.NavItemWidget","w444",0,0,0,0],
["components.nav.Nav.NavItemWidget","w445",0,0,0,0],
["components.nav.Nav.NavItemWidget","w446",0,0,0,0],
["components.nav.Nav.NavItemWidget","w447",0,0,0,0]],
["components.nav.Nav.NavItemWidget","w448",0,0,0,0,
["components.nav.Nav.NavItemWidget","w449",0,0,0,0],
["components.nav.Nav.NavItemWidget","w450",0,0,0,0],
["components.nav.Nav.NavItemWidget","w451",0,0,0,0],
["components.nav.Nav.NavItemWidget","w452",0,0,0,0],
["components.nav.Nav.NavItemWidget","w453",0,0,0,0],
["components.nav.Nav.NavItemWidget","w454",0,0,0,0],
["components.nav.Nav.NavItemWidget","w455",0,0,0,0]],
["components.nav.Nav.NavItemWidget","w456",0,0,0,0,
["components.nav.Nav.NavItemWidget","w457",0,0,0,0],
["components.nav.Nav.NavItemWidget","w458",0,0,0,0],
["components.nav.Nav.NavItemWidget","w459",0,0,0,0],
["components.nav.Nav.NavItemWidget","w460",0,0,0,0],
["components.nav.Nav.NavItemWidget","w461",0,0,0,0]],
["components/editors/CodeEditor/CodeEditorWidget","w462",{"mode":"xml","autoResize":true,"readOnly":true},0,0,0],
["components/editors/CodeEditor/CodeEditorWidget","w463",{"mode":"javascript","autoResize":true,"readOnly":true},0,0,0],
["components/editors/CodeEditor/CodeEditorWidget","w464",{"mode":"javascript","autoResize":true,"readOnly":true},0,0,0],
["components/editors/CodeEditor/CodeEditorWidget","w465",{"mode":"javascript","autoResize":true,"readOnly":true},0,0,0],
["components/editors/CodeEditor/CodeEditorWidget","w466",{"mode":"javascript","autoResize":true,"readOnly":true},0,0,0],
["components/editors/CodeEditor/CodeEditorWidget","w467",{"mode":"javascript","autoResize":true,"readOnly":true},0,0,0],
["components.social.Disqus.DisqusWidget","disqus_thread",{"shortName":"raptor-js","id":"module-loader-get-started-async","title":"RaptorJS: Get Started using the Asynchronous Module Loader"},0,0,0]);</script></body></html>